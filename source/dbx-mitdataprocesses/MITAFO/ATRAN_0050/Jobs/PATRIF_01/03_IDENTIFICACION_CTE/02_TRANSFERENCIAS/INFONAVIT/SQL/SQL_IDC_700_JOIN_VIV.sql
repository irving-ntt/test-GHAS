SELECT
  DER.FTC_ORIGEN_TRANSFE,
  DER.FTN_CONTA_SERV,
  DER.FTD_FEH_PRESEN,
  DER.FTC_CURP_TRABA,
  DER.FTC_NSS_TRABA_INFO,
  DER.FTN_NUM_CTA_AFORE,
  DER.FTC_RFC_TRABA_INFO,
  DER.FTC_APELLIDO_PATE_INFO,
  DER.FTC_APELLIDO_MATE_INFO,
  DER.FTC_NOMBRES_INFO,
  DER.FTC_IDENT_LOTE_SOLI,
  DER.FTC_NSS_TRABA_AFORE,
  DER.FTC_RFC_TRABA_AFORE,
  DER.FTC_APELLIDO_PATE_AFORE,
  DER.FTC_APELLIDO_MATE_AFORE,
  DER.FTC_NOMBRE_AFORE,
  DER.FTN_SALDO_VIVI97_SOLI,
  DER.FTC_CODIGO_RES_OPER,
  DER.FTC_DIAG_PROCESO,
  DER.FTC_NOMBRE_TRABA_IMSS,
  DER.FTC_NUMERO_CRED_INFONA,
  DER.FTN_PERIODO_PAGO,
  DER.FTD_FEH_CARGA,
  DER.FTC_FOLIO_BITACORA,
  DER.FTC_INDI_CUENTA_VIG,
  DER.FTD_FEH_VALOR_VIVI,
  DER.FTC_ESTATUS,
  DER.FTD_FEH_MOVIMIENTO,
  DER.FTN_NUM_APLI_INTE_VIVI97_ULT,
  DER.FTN_NUM_APLI_INTE_VIVI92_ENV,
  DER.FTN_NUM_APLI_INTE_VIVI97_ENV,
  DER.FTN_NUM_APLI_INTE_VIVI97_TRA,
  DER.FTN_NUM_APLI_INTE_VIVI92_SOL,
  DER.FTN_NUM_APLI_INTE_VIVI97_SOL,
  DER.FTN_IDENTI_MOVTO,
  DER.FTC_ESTATUS_REVE,
  DER.FTN_UTLIMA_APOR_VIVI97,
  DER.FTN_INTER_SALDO_VIVI97_ULT,
  DER.FTN_INTER_SALDO_VIVI92,
  DER.FTN_SALDO_TOT_VIVI92,
  DER.FTN_NUM_AIVS_VIVI97_ULT,
  DER.FTN_SALDO_VIVI97_ULT,
  DER.FTN_SALDO_VIVI97_TRAN,
  DER.FTN_ID_ARCHIVO,
  DER.FTN_ID_SUBP,
  DER.FTC_TIPO_ARCH,
  DER.FTN_NUM_CTA_INVDUAL,
  DER.FTN_ESTATUS_DIAG,
  DER.FTC_ID_DIAGNOSTICO,
  DER.FCN_ID_IND_CTA_INDV,
  DER.FFN_ID_CONFIG_INDI, 
  DER.FCC_VALOR_IND,
  DER.FTC_VIGENCIA,
  DER.FTN_DETALLE,
  DER.FTD_FEH_REG,
  IZQ.FTC_CORREO_ELEC, 
  IZQ.FTN_CELULAR
FROM (
    SELECT
      MCA.FTC_ORIGEN_TRANSFE,
      MCA.FTN_CONTA_SERV,
      MCA.FTD_FEH_PRESEN,
      MCA.FTC_CURP_TRABA,
      MCA.FTC_NSS_TRABA_INFO,
      MCA.FTN_NUM_CTA_AFORE,
      MCA.FTC_RFC_TRABA_INFO,
      MCA.FTC_APELLIDO_PATE_INFO,
      MCA.FTC_APELLIDO_MATE_INFO,
      MCA.FTC_NOMBRES_INFO,
      MCA.FTC_IDENT_LOTE_SOLI,
      MCA.FTC_NSS_TRABA_AFORE,
      MCA.FTC_RFC_TRABA_AFORE,
      MCA.FTC_APELLIDO_PATE_AFORE,
      MCA.FTC_APELLIDO_MATE_AFORE,
      MCA.FTC_NOMBRE_AFORE,
      MCA.FTN_SALDO_VIVI97_SOLI,
      MCA.FTC_CODIGO_RES_OPER,
      MCA.FTC_DIAG_PROCESO,
      MCA.FTC_NOMBRE_TRABA_IMSS,
      MCA.FTC_NUMERO_CRED_INFONA,
      MCA.FTN_PERIODO_PAGO,
      MCA.FTD_FEH_CARGA,
      MCA.FTC_FOLIO_BITACORA,
      MCA.FTC_INDI_CUENTA_VIG,
      MCA.FTD_FEH_VALOR_VIVI,
      MCA.FTC_ESTATUS,
      MCA.FTD_FEH_MOVIMIENTO,
      MCA.FTN_NUM_APLI_INTE_VIVI97_ULT,
      MCA.FTN_NUM_APLI_INTE_VIVI92_ENV,
      MCA.FTN_NUM_APLI_INTE_VIVI97_ENV,
      MCA.FTN_NUM_APLI_INTE_VIVI97_TRA,
      MCA.FTN_NUM_APLI_INTE_VIVI92_SOL,
      MCA.FTN_NUM_APLI_INTE_VIVI97_SOL,
      MCA.FTN_IDENTI_MOVTO,
      MCA.FTC_ESTATUS_REVE,
      MCA.FTN_UTLIMA_APOR_VIVI97,
      MCA.FTN_INTER_SALDO_VIVI97_ULT,
      MCA.FTN_INTER_SALDO_VIVI92,
      MCA.FTN_SALDO_TOT_VIVI92,
      MCA.FTN_NUM_AIVS_VIVI97_ULT,
      MCA.FTN_SALDO_VIVI97_ULT,
      MCA.FTN_SALDO_VIVI97_TRAN,
      MCA.FTN_ID_ARCHIVO,
      MCA.FTN_ID_SUBP,
      MCA.FTC_TIPO_ARCH,
      MCA.FTN_NUM_CTA_INVDUAL,
      MCA.FTN_ESTATUS_DIAG,
      MCA.FTC_ID_DIAGNOSTICO,
      VIV.FCN_ID_IND_CTA_INDV,
      VIV.FFN_ID_CONFIG_INDI, 
      VIV.FCC_VALOR_IND,
      VIV.FTC_VIGENCIA,
      VIV.FTN_DETALLE,
      VIV.FTD_FEH_REG
    FROM #DELTA_VAL_IDENT# MCA
    LEFT JOIN #DELTA_VIV# VIV
      ON MCA.FTN_NUM_CTA_INVDUAL = VIV.FTN_NUM_CTA_INVDUAL
    ORDER BY MCA.FTC_NSS_TRABA_AFORE, MCA.FTN_CONTA_SERV
) DER
LEFT JOIN 
(  SELECT 
      FTC_NSS, FTN_NUM_CTA_INVDUAL, FTC_CORREO_ELEC, FTN_CELULAR
    FROM #DELTA_BUC#
) IZQ
ON  DER.FTC_NSS_TRABA_AFORE = IZQ.FTC_NSS
AND DER.FTN_NUM_CTA_INVDUAL = IZQ.FTN_NUM_CTA_INVDUAL

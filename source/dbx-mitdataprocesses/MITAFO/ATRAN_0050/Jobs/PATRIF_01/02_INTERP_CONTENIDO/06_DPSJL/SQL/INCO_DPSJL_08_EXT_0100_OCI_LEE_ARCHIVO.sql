SELECT
---encabezado
SUBSTR(AE.FTC_LINEA,17,8) FTD_FEH_CRE_LOTE,
SUBSTR(AE.FTC_LINEA,28,8) FTD_FEH_LIM_RES,
TO_NUMBER(SUBSTR(AE.FTC_LINEA,25,3)) FTN_CONSEC_DIA,
---detalle 08
SUBSTR(AD8.FTC_LINEA,1,2) FTC_TIPO_REG,
SUBSTR(AD8.FTC_LINEA,3,2) FTC_IDENTI_SERV,
SUBSTR(AD8.FTC_LINEA,5,16) FTC_ID_PAGO,
--(Trim(SUBSTR (AD8.FTC_LINEA,21,15))/ 100) AS FTN_IMP_SOL_INSTITUTO, --SE COMENTA POR DUPLICIDAD, EN DATASTAGE SE TIENE ESTE DETALLE
SUBSTR(AD8.FTC_LINEA,36,8) FTD_LIQUIDACION,
(Trim(SUBSTR (AD8.FTC_LINEA,21,15))/ 100) AS FTN_IMP_SOL_INSTITUTO,
(Trim(SUBSTR(AD8.FTC_LINEA,44,15))/ 100) FTN_IMP_APACEP_RCV_DEV_ADM,
(Trim(SUBSTR(AD8.FTC_LINEA,59,15))/ 100) FTN_IMP_APEND_RCV_ADM,
(Trim(SUBSTR(AD8.FTC_LINEA,74,15))/ 100) FTN_IMP_APRECH_RCV_ADM,
(Trim(SUBSTR(AD8.FTC_LINEA,89,18))/ 1000000)FTN_NUM_APLI_INT_VIV_SOL_INST,
(Trim(SUBSTR(AD8.FTC_LINEA,107,18))/ 1000000)FTN_NUM_APLI_INT_VIV_ACDEV_ADM,
(Trim(SUBSTR(AD8.FTC_LINEA,125,18))/ 1000000)FTN_NUM_APLI_INT_VIV_PEND_ADM,
(Trim(SUBSTR(AD8.FTC_LINEA,143,18))/ 1000000)FTN_NUM_APLI_INT_VIV_RECH_ADM,
(Trim(SUBSTR(AD8.FTC_LINEA,161,15))/ 100)FTN_IMP_VIV_ACEP_DEV_ADM,
(Trim(SUBSTR(AD8.FTC_LINEA,176,15))/ 100)FTN_IMP_VIV_PEND_DEV_ADM,
(Trim(SUBSTR(AD8.FTC_LINEA,191,15))/ 100)FTN_IMP_VIV_RECH_DEV_ADM,
SUBSTR(AD8.FTC_LINEA,206,8) FTC_IND_SIEFORE,
SUBSTR(AD8.FTC_LINEA,214,3) FTC_TIPO_SIEFORE,
SUBSTR(AD8.FTC_LINEA,217,2) FTC_RES_OPERACION,
SUBSTR(AD8.FTC_LINEA,219,2) FTC_DIAGNOSTICO1,
SUBSTR(AD8.FTC_LINEA,222,2) FTC_DIAGNOSTICO2,
SUBSTR(AD8.FTC_LINEA,225,2) FTC_DIAGNOSTICO3
FROM CIERREN_ETL.TTSISGRAL_ETL_LEE_ARCHIVO AD8 
JOIN CIERREN_ETL.TTSISGRAL_ETL_LEE_ARCHIVO AE ON AD8.FTN_ID_ARCHIVO=AE.FTN_ID_ARCHIVO
WHERE AD8.FTN_ID_ARCHIVO = #sr_id_archivo#
AND SUBSTR(AE.FTC_LINEA,1,2) = '01'
AND SUBSTR(AD8.FTC_LINEA,1,2) = '08'
SELECT  
---encabezado
SUBSTR(AE.FTC_LINEA,17,8) FTD_FEH_CRE_LOTE,
SUBSTR(AE.FTC_LINEA,28,8) FTD_FEH_LIM_RES,
TO_NUMBER(SUBSTR(AE.FTC_LINEA,25,3)) FTN_CONSEC_DIA,
---detalle 02
SUBSTR(AD2.FTC_LINEA,1,2) FTC_TIPO_REG,
SUBSTR(AD2.FTC_LINEA,3,2) FTC_IDENTI_SERV,
TO_NUMBER(SUBSTR(AD2.FTC_LINEA,5,8)) FTN_CONSE_REG_LOTE,
SUBSTR(AD2.FTC_LINEA,13,11) FTC_NSS,
SUBSTR(AD2.FTC_LINEA,24,3) FTC_CLAVE_ENT_ORIG,
SUBSTR(AD2.FTC_LINEA,27,13) FTC_RFC_TRABA,
SUBSTR(AD2.FTC_LINEA,40,18) FTC_CURP,
SUBSTR(AD2.FTC_LINEA,58,50) FTC_NOMBRE,
TO_NUMBER(SUBSTR(AD2.FTC_LINEA,108,6)) FTN_PERIODO_PAGO,
SUBSTR(AD2.FTC_LINEA,114,8)FTD_FEH_PAGO,
SUBSTR(AD2.FTC_LINEA,122,8) FTD_FEH_VALOR_RCV,
SUBSTR(AD2.FTC_LINEA,130,8) FTD_FEH_VALOR_VIV,
TO_NUMBER(SUBSTR(AD2.FTC_LINEA,138,6)) FTN_FOLIO_SUA,
SUBSTR(AD2.FTC_LINEA,144,3) FNC_CVE_ENT_RECEP,
SUBSTR(AD2.FTC_LINEA,147,11) FNC_REG_PATRN_IMSS,
((Trim(SUBSTR(AD2.FTC_LINEA,158,9)))/ 100) FTN_IMP_RET_DEVOLVER,
((Trim(SUBSTR(AD2.FTC_LINEA,167,9)))/ 100) FTN_IMP_CES_CUO_PATRON_DEV,
((Trim(SUBSTR(AD2.FTC_LINEA,176,9)))/ 100) FTN_IMP_CES_CUO_TRABAJ_DEV,
((Trim(SUBSTR(AD2.FTC_LINEA,185,9)))/ 100) FTN_IMP_CUO_SOCIAL_DEV,
((Trim(SUBSTR(AD2.FTC_LINEA,194,9)))/ 100) FTN_IMP_ACT_REC_RETIRO_DEV,
((Trim(SUBSTR(AD2.FTC_LINEA,203,9)))/ 100) FTN_IMP_ACT_REC_CUO_PAT_DEV,
((Trim(SUBSTR(AD2.FTC_LINEA,212,9)))/ 100) FTN_IMP_ACT_REC_CUO_TRA_DEV,
((Trim(SUBSTR(AD2.FTC_LINEA,221,9)))/ 100) FTN_IMP_APOR_PAT_VIV_DEV,
TO_NUMBER(SUBSTR(AD2.FTC_LINEA,230,2)) FNN_DIAS_COTZDOS_BIM_DEV,
((Trim(SUBSTR(AD2.FTC_LINEA,232,15)))/ 1000000) FTN_NUM_APLI_VIV_APOR_PAT_DEV,
((Trim(SUBSTR(AD2.FTC_LINEA,247,9)))/ 100) FTN_IMP_ACT_RET_REN_CUENTA,
((Trim(SUBSTR(AD2.FTC_LINEA,256,9)))/ 100) FTN_IMP_ACT_REN_CUE_IND_PAT,
((Trim(SUBSTR(AD2.FTC_LINEA,265,9)))/ 100) FTN_IMP_ACT_REN_CUE_IND_TRA,
SUBSTR(AD2.FTC_LINEA,274,8) FTD_FEH_ENV_ORG_SOL_PROC,
SUBSTR(AD2.FTC_LINEA,282,2) FTC_DIAG_DEV,
SUBSTR(AD2.FTC_LINEA,284,3) FTC_MOT_DEV, 
SUBSTR(AD2.FTC_LINEA,287,2) FTC_RES_OPERACION,
SUBSTR(AD2.FTC_LINEA,289,2) FTC_DIAGNOSTICO1,
SUBSTR(AD2.FTC_LINEA,292,2) FTC_DIAGNOSTICO2,
SUBSTR(AD2.FTC_LINEA,295,2) FTC_DIAGNOSTICO3
FROM CIERREN_ETL.TTSISGRAL_ETL_LEE_ARCHIVO AD2 
JOIN CIERREN_ETL.TTSISGRAL_ETL_LEE_ARCHIVO AE ON AD2.FTN_ID_ARCHIVO=AE.FTN_ID_ARCHIVO
WHERE SUBSTR(AE.FTC_LINEA,1,2) = 01
AND SUBSTR(AD2.FTC_LINEA,1,2) = 2
AND  AD2.FTN_ID_ARCHIVO = #sr_id_archivo#
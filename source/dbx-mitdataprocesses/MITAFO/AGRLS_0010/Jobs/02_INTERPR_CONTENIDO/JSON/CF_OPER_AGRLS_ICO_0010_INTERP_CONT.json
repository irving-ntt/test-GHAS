{
  "flow" : "DOIMSS",
  "id" : "1",
  "steps" :
    [
        {
          "step_id" : "001",
          "source" : "cloud",
		      "description" : "Carga la informacion del archivo e inserta la informacion en la tabla de TTSISGRAL_ETL_LEE_ARCHIVO, SOLO contiene informacion de 02",
          "output_table" : "TTSISGRAL_ETL_LEE_ARCHIVO",
          "value" : [
          "SELECT"
          ,"    SUBSTR(FTC_LINEA,13,11) FTC_NSS"
          ,"    ,FTN_ID_ARCHIVO"
          ,"    ,SUBSTR(FTC_LINEA,181,7) FTC_IMPORTE_RETIRO"
          ,"    ,SUBSTR(FTC_LINEA,188,7) FTC_IMPORTE_ACT_RECARG_RETIRO"
          ,"    ,'151' FTC_SUBCTA_RETIRO"
          ,"    ,SUBSTR(FTC_LINEA,195,7) FTC_IMPORTE_CESANTIA_VEJEZ"
          ,"    ,SUBSTR (FTC_LINEA,202,7) FTC_IMP_ACT_REG_CESTIA_VEJEZ"
          ,"    ,'152' FTC_SUBCTA_CESANTIA_VEJEZ"
          ,"    ,SUBSTR (FTC_LINEA,209,7) FTC_IMPORTE_APORT_VOLUN"
          ,"    ,'169' FTC_SUBCTA_APORT_VOLUN"
          ,"    ,SUBSTR (FTC_LINEA,216,7) FTN_IMPORTE_APORT_COMPL_RETIRO"
          ,"    ,'171' FTC_SUBCTA_APORT_COMPL_RETIRO"
          ,"    ,SUBSTR (FTC_LINEA,223,7) FTC_IMPORTE_APORT_PATRONAL"
          ,"    ,SUBSTR (FTC_LINEA,280,1) FTC_ID_VIV_GARANTIA"
          ,"    ,SUBSTR (FTC_LINEA,281,15) FTC_APLIC_INTERES_VIVIENDA"
          ,"    ,SUBSTR (FTC_LINEA,307,7) FTC_IMPORT_REMAN_VIV"
          ,"    ,SUBSTR (FTC_LINEA,314,15) FTC_APLIC_INT_VIV_REMANENTE"
          ,"    ,SUBSTR (FTC_LINEA,329,7) FTC_INTER_PAGOS_EXT_VIVIENDA"
          ,"    ,SUBSTR (FTC_LINEA,336,15) FTC_APLIC_INTER_VIV_PAG_EXT"
          ,"    ,'165' FTC_SUBCTA_VIVIENDA"
          ,"    ,SUBSTR (FTC_LINEA,351,7) FTC_IMP_APORT_LARGO_PLAZO"
          ,"    ,'173' FTC_SUBCTA_APORT_LARGO_PLAZO"
          ,"    ,SUBSTR (FTC_LINEA,5,8) FTC_ID_REFERENCIA"
          ,"    ,SUBSTR(FTC_LINEA,37,18) FTC_CURP"
          ,"    ,FTN_NO_LINEA"
          ,"    ,SUBSTR (FTC_LINEA,1,2) FTN_TIPO_REG"
          ,"    ,decode(trim(SUBSTR(FTC_LINEA,365,2)),'',268,269) FLN_ID_LIB_APORT"
          ,"    ,TRIM(SUBSTR(FTC_LINEA,55,50)) FTC_NOMBRE"
          ,"    ,SUBSTR(FTC_LINEA,24,13) FTC_RFC"
          ,"    ,SUBSTR(FTC_LINEA,148,11) FCN_REG_PATRONAL_IMSS"
          ,"    ,SUBSTR(FTC_LINEA,105,6) FNC_PERIODO_PAGO_PATRON"
          ,"    ,SUBSTR(FTC_LINEA,111,8) FND_FECHA_PAGO"
          ,"    ,SUBSTR(FTC_LINEA,127,8) FND_FECHA_VALOR_IMSS_ACV"
          ,"    ,SUBSTR(FTC_LINEA,135,7) FNN_ULTIMO_SALARIO_INT_PER"
          ,"    ,SUBSTR(FTC_LINEA,142,6) FNC_FOLIO_PAGO_SUA"
          ,"    ,SUBSTR(FTC_LINEA,159,13) FNC_RFC_PATRON"
          ,"    ,SUBSTR(FTC_LINEA,175,2) FNN_DIAS_COTZDOS_BIM"
          ,"    ,SUBSTR(FTC_LINEA,177,2) FNN_DIAS_INCAP_BIMESTRE"
          ,"    ,SUBSTR(FTC_LINEA,179,2) FNN_DIAS_AUSENT_BIMESTRE"
          ,"    ,SUBSTR(FTC_LINEA,365,2) FNC_MOTIVO_LIBCION_APORT"
          ,"    ,SUBSTR(FTC_LINEA,272,8) FND_FECHA_PAGO_CUOTA_GUB"
          ,"    ,SUBSTR(FTC_LINEA,119,8) FND_FECHA_VALOR_RCV"
          ,"    ,SUBSTR(FTC_LINEA,172,3) FNN_CVE_ENT_RECEP_PAGO"
          ,"    ,SUBSTR(FTC_LINEA,172,3) FTC_CLAVE_ENT_RECEP_IMSS"
          ,"    ,SUBSTR(FTC_LINEA,13,3) FTC_CLAVE_ENT_RECEP_ISSSTE"
          ,"    ,SUBSTR(FTC_LINEA,24,13) FTC_RFC_IMSS"
          ,"    ,SUBSTR(FTC_LINEA,129,13) FTC_RFC_ISSSTE"
          ,"    ,SUBSTR(FTC_LINEA,55,50) FTC_NOMBRE_CTE_IMSS"
          ,"    ,TRIM(SUBSTR(FTC_LINEA,240,40)) || ' ' || TRIM(SUBSTR(FTC_LINEA,160,40)) || ' ' || TRIM(SUBSTR(FTC_LINEA,200,40)) FTC_NOMBRE_CTE_ISSSTE"
          ,"FROM CIERREN_ETL.TTSISGRAL_ETL_LEE_ARCHIVO"
          ,"WHERE 1 = 1"
          ,"  AND SUBSTR(FTC_LINEA,1,2) = '#PARAM@2#'"
          ,"  AND FTN_ID_ARCHIVO = #PARAM@3#"
          ]
        },
        {
          "step_id" : "002",
          "source" : "oracle",
		      "description" : "Lee la informacion desde TCCRXGRAL_TIPO_SUBCTA, TCCRXGRAL_TIPO_CAT, TCCRXGRAL_CAT_CATALOGO. Revisar el ultimo filtro en el ID_CAT_SUBCTA",
          "value" : [
          "SELECT SUBC.FCN_ID_CAT_SUBCTA"
          ,"    ,SUBC.FCN_ID_GRUPO"
          ,"    ,SUBC.FCN_ID_TIPO_SUBCTA"
          ,"FROM CIERREN.TCCRXGRAL_TIPO_SUBCTA SUBC"
          ,"    JOIN"
          ,"    ("
          ,"        SELECT FCN_ID_CAT_CATALOGO REGIMEN"
          ,"        FROM TCCRXGRAL_TIPO_CAT TC"
          ,"            JOIN CIERREN.TCCRXGRAL_CAT_CATALOGO CAT ON TC.FCN_ID_TIPO_CAT = CAT.FCN_ID_TIPO_CAT"
          ,"        WHERE TC.FCN_ID_TIPO_CAT = 21"
          ,"            AND TC.FCB_VIGENCIA = 1"
          ,"            AND CAT.FCB_VIGENCIA = 1"
          ,"            AND CAT.FCN_ID_CAT_CATALOGO in (138,140)"
          ,"    ) CAT"
          ,"ON SUBC.FCN_ID_REGIMEN = CAT.REGIMEN"
          ,"WHERE SUBC.FCN_ID_CAT_SUBCTA IN ('151', '152', '169', '171', '165', '173')"
          ]
        },
        {
          "step_id" : "003",
          "source" : "oracle",
		      "description" : "Lee la informacion desde TCCRXGRAL_TIPO_SUBCTA, TCCRXGRAL_TIPO_CAT, TCCRXGRAL_CAT_CATALOGO. Revisar el ultimo filtro en el ID_CAT_SUBCTA",
          "value" : [
          "SELECT"
          ,"/*COMENTARIO*/"
          ,"    TO_DATE(SUBSTR(FTC_LINEA,17,8),'YYYYMMDD') FND_FECTRA"
          ,"    ,SUBSTR(FTC_LINEA,25,3) FNN_SECLOT"
          ,"    ,FTN_ID_ARCHIVO"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND SUBSTR(FTC_LINEA,1,2) = '#PARAM@2#'"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@3#"
          ]
        },
        {
          "step_id" : "004",
		      "description" : "Lee la informacion desde TTSISGRAL_ETL_LEE_ARCHIVO_TB e inserta una tabla completa del archivo cargado en TTSISGRAL_ETL_LEE_ARCHIVO_FULL_TB",
          "value" : [
          "WITH CAT AS (SELECT * FROM #PARAM@3#)"
          ,"SELECT"
          ,"    LEE.FTC_NSS"
          ,"    ,LEE.FTN_ID_ARCHIVO"
          ,"    ,LEE.FTC_IMPORTE_RETIRO"
          ,"    ,LEE.FTC_IMPORTE_ACT_RECARG_RETIRO"
          ,"    ,LEE.FTC_SUBCTA_RETIRO"
          ,"    ,(SELECT MAX(NVL(FCN_ID_TIPO_SUBCTA, '')) FROM CAT WHERE LEE.FTC_SUBCTA_RETIRO = CAT.FCN_ID_CAT_SUBCTA) FCN_ID_TIPO_SUBCTA"
          ,"    ,LEE.FTC_IMPORTE_CESANTIA_VEJEZ"
          ,"    ,LEE.FTC_IMP_ACT_REG_CESTIA_VEJEZ"
          ,"    ,LEE.FTC_SUBCTA_CESANTIA_VEJEZ"
          ,"    ,(SELECT MAX(NVL(FCN_ID_TIPO_SUBCTA, '')) FROM CAT WHERE LEE.FTC_SUBCTA_CESANTIA_VEJEZ = CAT.FCN_ID_CAT_SUBCTA) FCN_ID_TIPO_SUBCTA_CESANTIA_VEJEZ"
          ,"    ,LEE.FTC_IMPORTE_APORT_VOLUN"
          ,"    ,LEE.FTC_SUBCTA_APORT_VOLUN"
          ,"    ,(SELECT MAX(NVL(FCN_ID_TIPO_SUBCTA, '')) FROM CAT WHERE LEE.FTC_SUBCTA_APORT_VOLUN = CAT.FCN_ID_CAT_SUBCTA) FCN_ID_TIPO_SUBCTA_APORT_VOLUN"
          ,"    ,LEE.FTN_IMPORTE_APORT_COMPL_RETIRO"
          ,"    ,LEE.FTC_SUBCTA_APORT_COMPL_RETIRO"
          ,"    ,(SELECT MAX(NVL(FCN_ID_TIPO_SUBCTA, '')) FROM CAT WHERE LEE.FTC_SUBCTA_APORT_COMPL_RETIRO = CAT.FCN_ID_CAT_SUBCTA) FCN_ID_TIPO_SUBCTA_APORT_COMPL_RETIRO"
          ,"    ,LEE.FTC_IMPORTE_APORT_PATRONAL"
          ,"    ,LEE.FTC_ID_VIV_GARANTIA"
          ,"    ,LEE.FTC_APLIC_INTERES_VIVIENDA FTC_APLIC_INTERES_VIVIENDA"
          ,"    ,LEE.FTC_IMPORT_REMAN_VIV"
          ,"    ,LEE.FTC_APLIC_INT_VIV_REMANENTE"
          ,"    ,LEE.FTC_INTER_PAGOS_EXT_VIVIENDA"
          ,"    ,LEE.FTC_APLIC_INTER_VIV_PAG_EXT"
          ,"    ,LEE.FTC_SUBCTA_VIVIENDA"
          ,"    ,(SELECT MAX(NVL(FCN_ID_TIPO_SUBCTA, '')) FROM CAT WHERE LEE.FTC_SUBCTA_VIVIENDA = CAT.FCN_ID_CAT_SUBCTA) FCN_ID_TIPO_SUBCTA_VIVIENDA"
          ,"    ,LEE.FTC_IMP_APORT_LARGO_PLAZO"
          ,"    ,LEE.FTC_SUBCTA_APORT_LARGO_PLAZO"
          ,"    ,(SELECT MAX(NVL(FCN_ID_TIPO_SUBCTA, '')) FROM CAT WHERE LEE.FTC_SUBCTA_APORT_LARGO_PLAZO = CAT.FCN_ID_CAT_SUBCTA) FCN_ID_TIPO_SUBCTA_APORT_LARGO_PLAZO"
          ,"    ,LEE.FTC_ID_REFERENCIA"
          ,"    ,LEE.FTC_CURP"
          ,"    ,LEE.FTN_NO_LINEA"
          ,"    ,LEE.FTN_TIPO_REG"
          ,"    ,LEE.FLN_ID_LIB_APORT"
          ,"    ,LEE.FTC_NOMBRE"
          ,"    ,LEE.FTC_RFC"
          ,"    ,LEE.FCN_REG_PATRONAL_IMSS"
          ,"    ,LEE.FNC_PERIODO_PAGO_PATRON"
          ,"    ,to_date(LEE.FND_FECHA_PAGO, 'yyyyMMdd') FND_FECHA_PAGO"
          ,"    ,to_date(LEE.FND_FECHA_VALOR_IMSS_ACV, 'yyyyMMdd') FND_FECHA_VALOR_IMSS_ACV"
          ,"    ,CONCAT(substr(LEE.FNN_ULTIMO_SALARIO_INT_PER,1, 5), '.', substr(LEE.FNN_ULTIMO_SALARIO_INT_PER,6, 2)) FNN_ULTIMO_SALARIO_INT_PER"
          ,"    ,LEE.FNC_FOLIO_PAGO_SUA"
          ,"    ,LEE.FNC_RFC_PATRON"
          ,"    ,LEE.FNN_DIAS_COTZDOS_BIM"
          ,"    ,LEE.FNN_DIAS_INCAP_BIMESTRE"
          ,"    ,LEE.FNN_DIAS_AUSENT_BIMESTRE"
          ,"    ,LEE.FNC_MOTIVO_LIBCION_APORT"
          ,"    ,DECODE(LEE.FND_FECHA_PAGO_CUOTA_GUB, '00010101', '', to_date(LEE.FND_FECHA_PAGO_CUOTA_GUB, 'yyyyMMdd')) FND_FECHA_PAGO_CUOTA_GUB"
          ,"    ,to_date(LEE.FND_FECHA_VALOR_RCV, 'yyyyMMdd') FND_FECHA_VALOR_RCV"
          ,"    ,LEE.FNN_CVE_ENT_RECEP_PAGO"
          ,"    ,DECODE(#PARAM@5#, 120, LEE.FTC_CURP, 122, LEE.FTC_CURP, 210, LEE.FTC_CURP, 105, LEE.FTC_CURP, LEE.FTC_NSS) FTN_NSS_CURP"
          ,"    ,LEE.FTC_CLAVE_ENT_RECEP_IMSS"
          ,"    ,LEE.FTC_CLAVE_ENT_RECEP_ISSSTE"
          ,"    ,LEE.FTC_RFC_IMSS"
          ,"    ,LEE.FTC_RFC_ISSSTE"
          ,"    ,LEE.FTC_NOMBRE_CTE_IMSS"
          ,"    ,LEE.FTC_NOMBRE_CTE_ISSSTE"
          ,"    ,ENC.FNN_SECLOT"
          ,"    ,to_date(ENC.FND_FECTRA, 'yyyy-MM-dd') FND_FECTRA"
          ,"FROM #PARAM@1# LEE"
          ,"   INNER JOIN #PARAM@2# ENC"
          ,"        ON LEE.FTN_ID_ARCHIVO = ENC.FTN_ID_ARCHIVO"
          ,"WHERE"
          ,"   LEE.FTN_ID_ARCHIVO = #PARAM@4#"
          ]
        },
        {
          "step_id" : "005",
          "source" : "oracle",
		      "description" : "Inserta en CIERREN_ETL.TTSISGRAL_ETL_PRE_DISPERSION",
          "value" : [
          "SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA FNN_ID_REFERENCIA, 7 FCN_ID_PROCESO, 8 FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA, FTC_IMPORTE_RETIRO/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'RCV' FTC_TABLA_NCI_MOV, 0 FNN_ID_VIV_GARANTIA"
          ,"    ,221 FFN_ID_CONCEPTO_MOV, FTC_NSS FTN_NSS, FTC_CURP, 20 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA, FTC_IMPORTE_ACT_RECARG_RETIRO/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'RCV' FTC_TABLA_NCI_MOV, 0 FNN_ID_VIV_GARANTIA"
          ,"    ,222 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 21 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_CESANTIA_VEJEZ AS FCN_ID_TIPO_SUBCTA, FTC_IMPORTE_CESANTIA_VEJEZ/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'RCV' FTC_TABLA_NCI_MOV, 0 FNN_ID_VIV_GARANTIA"
          ,"    ,223 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 22 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_CESANTIA_VEJEZ AS FCN_ID_TIPO_SUBCTA, FTC_IMP_ACT_REG_CESTIA_VEJEZ/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'RCV' FTC_TABLA_NCI_MOV, 0 FNN_ID_VIV_GARANTIA"
          ,"    ,224 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 23 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_APORT_VOLUN FCN_ID_TIPO_SUBCTA, FTC_IMPORTE_APORT_VOLUN/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'AVO' FTC_TABLA_NCI_MOV, 0 FNN_ID_VIV_GARANTIA"
          ,"    ,228 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 24 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_APORT_COMPL_RETIRO FCN_ID_TIPO_SUBCTA, FTN_IMPORTE_APORT_COMPL_RETIRO/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'COM' FTC_TABLA_NCI_MOV, 0 FNN_ID_VIV_GARANTIA"
          ,"    ,229 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 25 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_VIVIENDA FCN_ID_TIPO_SUBCTA, FTC_IMPORTE_APORT_PATRONAL/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'VIV' FTC_TABLA_NCI_MOV, FTC_ID_VIV_GARANTIA FNN_ID_VIV_GARANTIA"
          ,"    ,225 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 26 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_VIVIENDA FCN_ID_TIPO_SUBCTA, 0 FTF_MONTO_PESOS"
          ,"    ,FTC_APLIC_INTERES_VIVIENDA/1000000 FTF_MONTO_ACCIONES, 'VIV' FTC_TABLA_NCI_MOV, FTC_ID_VIV_GARANTIA FNN_ID_VIV_GARANTIA"
          ,"    ,270 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 35 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_VIVIENDA FCN_ID_TIPO_SUBCTA, FTC_IMPORT_REMAN_VIV/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'VIV' FTC_TABLA_NCI_MOV, '' FNN_ID_VIV_GARANTIA"
          ,"    ,226 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 37 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_VIVIENDA FCN_ID_TIPO_SUBCTA, FTC_INTER_PAGOS_EXT_VIVIENDA/100 FTF_MONTO_PESOS"
          ,"    ,FTC_APLIC_INTER_VIV_PAG_EXT/1000000 FTF_MONTO_ACCIONES, 'VIV' FTC_TABLA_NCI_MOV, '' FNN_ID_VIV_GARANTIA"
          ,"    ,227 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 39 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_APORT_LARGO_PLAZO FCN_ID_TIPO_SUBCTA, FTC_IMP_APORT_LARGO_PLAZO/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'AVO' FTC_TABLA_NCI_MOV, 0 FNN_ID_VIV_GARANTIA"
          ,"    ,230 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 41 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_VIVIENDA FCN_ID_TIPO_SUBCTA, FTC_IMPORTE_APORT_PATRONAL/100 FTF_MONTO_PESOS"
          ,"    ,0 FTF_MONTO_ACCIONES, 'VIV' FTC_TABLA_NCI_MOV, FTC_ID_VIV_GARANTIA FNN_ID_VIV_GARANTIA"
          ,"    ,231 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 26 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND CAST(FTC_ID_VIV_GARANTIA AS STRING) = '1'"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_VIVIENDA FCN_ID_TIPO_SUBCTA, 0 FTF_MONTO_PESOS"
          ,"    ,FTC_APLIC_INT_VIV_REMANENTE/1000000 FTF_MONTO_ACCIONES, 'VIV' FTC_TABLA_NCI_MOV, '' FNN_ID_VIV_GARANTIA"
          ,"    ,271 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 38 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ,"UNION ALL"
          ,"SELECT '#PARAM@2#' FTC_FOLIO, FTN_ID_ARCHIVO, FTN_NO_LINEA, FTC_ID_REFERENCIA, #PARAM@3# FCN_ID_PROCESO, #PARAM@4# FCN_ID_SUBPROCESO, FCN_ID_TIPO_SUBCTA_VIVIENDA FCN_ID_TIPO_SUBCTA, 0 FTF_MONTO_PESOS"
          ,"    ,FTC_APLIC_INTER_VIV_PAG_EXT/1000000 FTF_MONTO_ACCIONES, 'VIV' FTC_TABLA_NCI_MOV, '' FNN_ID_VIV_GARANTIA"
          ,"    ,272 FNN_ID_CONCEPTO_MOV, FTC_NSS, FTC_CURP, 40 FTN_ID_MONTO, FLN_ID_LIB_APORT, FTC_NOMBRE"
          ,"FROM #PARAM@1#"
          ,"WHERE 1=1"
          ,"    AND FTN_ID_ARCHIVO = #PARAM@5#"
          ]
        },
        {
          "step_id" : "006",
          "source" : "oracle",
		      "description" : "Inserta en CIERREN_ETL.TLSISGRAL_ETL_CLIENTE_SUA",
          "value" : [
          "SELECT"
          ,"    CAST(FTC_ID_REFERENCIA AS INT) FNN_ID_REFERENCIA"
          ,"    ,'#PARAM@2#' FTC_FOLIO"
          ,"    ,FTC_NSS as FTN_NSS"
          ,"    ,FTC_RFC"
          ,"    ,FTC_CURP"
          ,"    ,FTC_NOMBRE"
          ,"    ,FNC_PERIODO_PAGO_PATRON"
          ,"    ,FND_FECHA_PAGO"
          ,"    ,FND_FECHA_VALOR_IMSS_ACV FND_FECHA_VALOR_IMSS_ACV_VIV"
          ,"    ,CAST(FNN_ULTIMO_SALARIO_INT_PER AS DOUBLE) FNN_ULTIMO_SALARIO_INT_PER"
          ,"    ,FNC_FOLIO_PAGO_SUA"
          ,"    ,FCN_REG_PATRONAL_IMSS as FNC_REG_PATRONAL_IMSS"
          ,"    ,FNC_RFC_PATRON"
          ,"    ,CAST(FNN_DIAS_COTZDOS_BIM AS INT) FNN_DIAS_COTZDOS_BIMESTRE"
          ,"    ,CAST(FNN_DIAS_INCAP_BIMESTRE AS INT) FNN_DIAS_INCAP_BIMESTRE"
          ,"    ,CAST(FNN_DIAS_AUSENT_BIMESTRE AS INT) FNN_DIAS_AUSENT_BIMESTRE"
          ,"    ,CAST(FTC_ID_VIV_GARANTIA AS INT) FNN_ID_VIV_GARANTIA"
          ,"    ,CASE WHEN CAST(FTC_APLIC_INTERES_VIVIENDA AS DOUBLE) > 999999999 THEN 0 ELSE CAST(FTC_APLIC_INTERES_VIVIENDA AS DOUBLE) END FNN_APLIC_INT_VIVIENDA"
          ,"    ,FNC_MOTIVO_LIBCION_APORT"
          ,"    ,FND_FECHA_PAGO_CUOTA_GUB"
          ,"    ,FND_FECHA_VALOR_RCV"
          ,"    ,CAST(FNN_CVE_ENT_RECEP_PAGO AS INT) FNN_CVE_ENT_RECEP_PAGO"
          ,"    ,0 FNN_NSS_ISSSTE"
          ,"    ,'' FNC_DEPEND_CTRO_PAGO"
          ,"    ,0 FNN_CTRO_PAGO_SAR"
          ,"    ,0 FNN_CVE_RAMO"
          ,"    ,'' FNC_CVE_PAGADURIA"
          ,"    ,0 FNN_SUELDO_BASICO_COTIZ_RCV"
          ,"    ,'' FNC_ID_TRABAJADOR_BONO"
          ,"    ,to_timestamp('#PARAM@3#', 'dd/MM/yy HH:mm:ss') FND_FEH_CRE"
          ,"    ,'#PARAM@4#' FNC_USU_CRE"
          ,"    ,0 FTN_INTERESES_VIV92"
          ,"    ,0 FTN_INTERESES_VIV08"
          ,"    ,CAST('#PARAM@5#' AS INT) FCN_ID_PROCESO"
          ,"    ,CAST('#PARAM@6#' AS INT) FCN_ID_SUBPROCESO"
          ,"    ,'#PARAM@7#' FNC_TIPREG"
          ,"    ,CAST(FTN_NO_LINEA AS INT) FTN_CONS_REG_LOTE"
          ,"    ,CAST(FTN_ID_ARCHIVO AS INT) as FNN_ID_ARCHIVO"
          ,"    ,'' FCN_ID_TIPO_APO"
          ,"    ,FNN_SECLOT"
          ,"    ,to_date(FND_FECTRA, 'dd/MM/yy') FND_FECTRA"
          ,"FROM #PARAM@1#"
          ]
        },
        {
          "step_id" : "007",
          "source" : "oracle",
		      "description" : "Lee la informacion desde TCCRXGRAL_TIPO_SUBCTA, TCCRXGRAL_TIPO_CAT, TCCRXGRAL_CAT_CATALOGO. Revisar el ultimo filtro en el ID_CAT_SUBCTA",
          "value" : [
          "SELECT"
          ,"    FTN_ID_ARCHIVO"
          ,"    ,FTN_NO_LINEA"
          ,"    ,FTC_ID_REFERENCIA as FNN_ID_REFERENCIA"
          ,"    ,FCN_ID_TIPO_SUBCTA"
          ,"    ,FTF_MONTO_PESOS"
          ,"    ,FTF_MONTO_ACCIONES"
          ,"    ,FTC_TABLA_NCI_MOV"
          ,"    ,FNN_ID_VIV_GARANTIA"
          ,"    ,FNN_ID_CONCEPTO_MOV as FFN_ID_CONCEPTO_MOV"
          ,"    ,FCN_ID_PROCESO"
          ,"    ,FCN_ID_SUBPROCESO"
          ,"    ,FTC_FOLIO"
          ,"    ,FTC_NSS as FTN_NSS"
          ,"    ,FTC_CURP"
          ,"    ,FTC_NOMBRE"
          ,"    ,FTN_ID_MONTO"
          ,"    ,'' FCN_ID_REGIMEN"
          ,"    ,'' FTN_TIPO_REG"
          ,"    ,FLN_ID_LIB_APORT"
          ,"    ,'' FTC_RFC"
          ,"    ,'' FCN_REG_PATRONAL_IMSS"
          ,"FROM #PARAM@1#"
          ]
        }
    ]
}
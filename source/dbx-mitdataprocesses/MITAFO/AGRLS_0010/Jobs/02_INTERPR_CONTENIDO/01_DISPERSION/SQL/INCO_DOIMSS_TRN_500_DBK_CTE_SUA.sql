SELECT 
    CAST(FTC_ID_REFERENCIA AS integer) AS FNN_ID_REFERENCIA,
    '#sr_folio#' AS FTC_FOLIO,
    FTC_NSS AS FTN_NSS,
    FTC_RFC AS FTC_RFC,
    FTC_CURP AS FTC_CURP,
    FTC_NOMBRE AS FTC_NOMBRE,
    FNC_PERIODO_PAGO_PATRON AS FNC_PERIODO_PAGO_PATRON,
    TO_DATE(FND_FECHA_PAGO, 'yyyyMMdd') AS FND_FECHA_PAGO,
    TO_DATE(FND_FECHA_VALOR_IMSS_ACV, 'yyyyMMdd') AS FND_FECHA_VALOR_IMSS_ACV_VIV,
    CAST(CONCAT(SUBSTRING(FNN_ULTIMO_SALARIO_INT_PER, 1, 5), '.', RIGHT(FNN_ULTIMO_SALARIO_INT_PER, 2)) AS DECIMAL(18,2)) AS FNN_ULTIMO_SALARIO_INT_PER,
    FNC_FOLIO_PAGO_SUA,
    FNC_REG_PATRONAL_IMSS,
    FNC_RFC_PATRON,
    FNN_DIAS_COTZDOS_BIM AS FNN_DIAS_COTZDOS_BIMESTRE,
    FNN_DIAS_INCAP_BIMESTRE,
    FNN_DIAS_AUSENT_BIMESTRE,
    FNN_ID_VIV_GARANTIA AS FNN_ID_VIV_GARANTIA,
    CASE WHEN CAST(FNN_APLIC_INT_VIVIENDA AS DECIMAL(20,6)) > 999999999 THEN 0 ELSE FNN_APLIC_INT_VIVIENDA end AS FNN_APLIC_INT_VIVIENDA,
   -- FNN_APLIC_INT_VIVIENDA AS FNN_APLIC_INT_VIVIENDA,
    FNC_MOTIVO_LIBCION_APORT,
    CASE WHEN FND_FECHA_PAGO_CUOTA_GUB = '00010101' THEN NULL ELSE TO_DATE(FND_FECHA_PAGO_CUOTA_GUB, 'yyyyMMdd') END  FND_FECHA_PAGO_CUOTA_GUB,
    TO_DATE(FND_FECHA_VALOR_RCV, 'yyyyMMdd') AS FND_FECHA_VALOR_RCV,
    FNN_CVE_ENT_RECEP_PAGO,
    0 AS FNN_NSS_ISSSTE,
    '' AS FNC_DEPEND_CTRO_PAGO,
    0 AS FNN_CTRO_PAGO_SAR,
    0 AS FNN_CVE_RAMO,
    '' AS FNC_CVE_PAGADURIA,
    0 AS FNN_SUELDO_BASICO_COTIZ_RCV,
    '' AS FNC_ID_TRABAJADOR_BONO,
    to_timestamp(from_utc_timestamp(CURRENT_TIMESTAMP, 'GMT-6')) AS FND_FEH_CRE,
    'DATABRICKS' AS FNC_USU_CRE,
    0 AS FTN_INTERESES_VIV92,
    0 AS FTN_INTERESES_VIV08,
    #sr_proceso# AS FCN_ID_PROCESO,
    #sr_subproceso# AS FCN_ID_SUBPROCESO,
    '02' AS FNC_TIPREG,
    FTN_NO_LINEA AS FTN_CONS_REG_LOTE,
    FTN_ID_ARCHIVO AS FNN_ID_ARCHIVO,
    NULL AS FCN_ID_TIPO_APO 
FROM #DELTA_TABLA_NAME1#
--IMSS
SELECT 
    CAST(FTC_ID_REFERENCIA AS integer) AS FNN_ID_REFERENCIA,
    '#sr_folio#' AS FTC_FOLIO,
    FTC_NSS_IMSS AS FTN_NSS,
    FTC_RFC_IMSS AS FTC_RFC,
    FTC_CURP_IMSS AS FTC_CURP,
    SUBSTR(FTC_NOMBRE_IMSS , 1,50) AS FTC_NOMBRE,
    FNC_PERIODO_PAGO_PATRON_IMSS AS FNC_PERIODO_PAGO_PATRON,
    TO_DATE(FND_FECHA_PAGO_IMSS, 'yyyyMMdd') AS FND_FECHA_PAGO,
    TO_DATE(FND_FECHA_VALOR_IMSS_ACV_IMSS, 'yyyyMMdd') AS FND_FECHA_VALOR_IMSS_ACV_VIV,
    CAST(CONCAT(SUBSTRING(FNN_ULTIMO_SALARIO_INT_IMSS, 1, 5), '.', RIGHT(FNN_ULTIMO_SALARIO_INT_IMSS, 2)) AS DECIMAL(18,2)) AS FNN_ULTIMO_SALARIO_INT_PER,
    FNC_FOLIO_PAGO_SUA_IMSS AS FNC_FOLIO_PAGO_SUA,
    FNC_REG_PATRONAL_IMSS_IMSS AS FNC_REG_PATRONAL_IMSS,
    FNC_RFC_PATRON_IMSS AS FNC_RFC_PATRON,
    FNN_DIAS_COTZDOS_BIM_IMSS AS FNN_DIAS_COTZDOS_BIMESTRE,
    FNN_DIAS_INCAP_BIMESTRE_IMSS AS FNN_DIAS_INCAP_BIMESTRE,
    FNN_DIAS_AUSENT_BIMESTRE_IMSS AS FNN_DIAS_AUSENT_BIMESTRE,
    0 AS FNN_ID_VIV_GARANTIA,
    0 AS FNN_APLIC_INT_VIVIENDA,
    '' AS FNC_MOTIVO_LIBCION_APORT,
    TO_DATE(FND_FECHA_PAGO_CUOTA_GUB_IMSS, 'yyyyMMdd') AS FND_FECHA_PAGO_CUOTA_GUB,
    TO_DATE(FND_FECHA_VALOR_RCV_IMSS, 'yyyyMMdd') AS FND_FECHA_VALOR_RCV,
    FNN_CVE_ENT_RECEP_PAGO_IMSS AS FNN_CVE_ENT_RECEP_PAGO,
    0 AS FNN_NSS_ISSSTE,
    '' AS FNC_DEPEND_CTRO_PAGO,
    0 AS FNN_CTRO_PAGO_SAR,
    0 AS FNN_CVE_RAMO,
    '' AS FNC_CVE_PAGADURIA,
    0 AS FNN_SUELDO_BASICO_COTIZ_RCV,
    '' AS FNC_ID_TRABAJADOR_BONO,
    to_timestamp(from_utc_timestamp(CURRENT_TIMESTAMP, 'GMT-6')) AS FND_FEH_CRE,
    'DATABRICKS' AS FNC_USU_CRE,
    0 AS FTN_INTERESES_VIV92,
    0 AS FTN_INTERESES_VIV08,
    7 AS FCN_ID_PROCESO,
    439 AS FCN_ID_SUBPROCESO,
    '02' AS FNC_TIPREG,
    FTN_NO_LINEA AS FTN_CONS_REG_LOTE,
    FTN_ID_ARCHIVO AS FNN_ID_ARCHIVO,
    NULL AS FCN_ID_TIPO_APO 
FROM #DELTA_TABLA_NAME1#
WHERE #sr_proceso# = "7" And #sr_subproceso# = "439" 

UNION ALL
--ISSSTE
SELECT 
    CAST(FTC_ID_REFERENCIA AS integer) AS FNN_ID_REFERENCIA,
    '#sr_folio#' AS FTC_FOLIO,
    FTC_NSS AS FTN_NSS,
    FTC_RFC AS FTC_RFC,
    FTC_CURP AS FTC_CURP,
    SUBSTR(FTC_NOMBRE_ISSSTE , 1,50) AS FTC_NOMBRE,
    FNC_PERIODO_PAGO_PATRON AS FNC_PERIODO_PAGO_PATRON,
    TO_DATE(FND_FECHA_PAGO, 'yyyyMMdd') AS FND_FECHA_PAGO,
    TO_DATE(FND_FECHA_VALOR_IMSS_ACV, 'yyyyMMdd') AS FND_FECHA_VALOR_IMSS_ACV_VIV,
    0 AS FNN_ULTIMO_SALARIO_INT_PER,
    '' AS FNC_FOLIO_PAGO_SUA,
    '' AS FNC_REG_PATRONAL_IMSS,
    FNC_RFC_PATRON AS FNC_RFC_PATRON,
    FNN_DIAS_COTZDOS_BIM AS FNN_DIAS_COTZDOS_BIMESTRE,
    FNN_DIAS_INCAP_BIMESTRE AS FNN_DIAS_INCAP_BIMESTRE,
    FNN_DIAS_AUSENT_BIMESTRE AS FNN_DIAS_AUSENT_BIMESTRE,
    FNN_ID_VIV_GARANTIA AS FNN_ID_VIV_GARANTIA,
    0 AS FNN_APLIC_INT_VIVIENDA,
    '' AS FNC_MOTIVO_LIBCION_APORT,
    NULL AS FND_FECHA_PAGO_CUOTA_GUB,
    TO_DATE(FND_FECHA_VALOR_RCV, 'yyyyMMdd') AS FND_FECHA_VALOR_RCV,
    FNN_CVE_ENT_RECEP_PAGO AS FNN_CVE_ENT_RECEP_PAGO,
    FTC_NSS_SEGUN_ISSSTE AS FNN_NSS_ISSSTE,
    FNC_DEPEND_CTRO_PAGO AS FNC_DEPEND_CTRO_PAGO,
    FNN_CTRO_PAGO_SAR AS FNN_CTRO_PAGO_SAR,
    FNN_CVE_RAMO AS FNN_CVE_RAMO,
    FNC_CVE_PAGADURIA AS FNC_CVE_PAGADURIA,
    CAST(CONCAT(SUBSTRING(FNN_SUELDO_BASICO_COTIZ_RCV, 1, 5), '.', RIGHT(FNN_SUELDO_BASICO_COTIZ_RCV, 2)) AS DECIMAL(18,2)) AS  FNN_SUELDO_BASICO_COTIZ_RCV,
    FNC_ID_TRABAJADOR_BONO AS FNC_ID_TRABAJADOR_BONO,
    to_timestamp(from_utc_timestamp(CURRENT_TIMESTAMP, 'GMT-6')) AS FND_FEH_CRE,
    'DATABRICKS' AS FNC_USU_CRE,
    0 AS FTN_INTERESES_VIV92,
    0 AS FTN_INTERESES_VIV08,
    7 AS FCN_ID_PROCESO,
    210 AS FCN_ID_SUBPROCESO,
    '02' AS FNC_TIPREG,
    FTN_NO_LINEA AS FTN_CONS_REG_LOTE,
    FTN_ID_ARCHIVO AS FNN_ID_ARCHIVO,
    FCN_ID_TIPO_APO AS FCN_ID_TIPO_APO 
FROM #DELTA_TABLA_NAME1#
WHERE #sr_proceso# = "7" And #sr_subproceso# = "210" 
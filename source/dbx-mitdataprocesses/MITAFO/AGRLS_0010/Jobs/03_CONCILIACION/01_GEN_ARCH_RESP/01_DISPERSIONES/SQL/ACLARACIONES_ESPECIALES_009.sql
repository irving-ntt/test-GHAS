SELECT
    FTN_ID_ARCHIVO,
    SUM(CASE WHEN FTN_ID_MONTO = 26 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_SAR_26,
    SUM(CASE WHEN FTN_ID_MONTO = 27 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_RET_27,
    SUM(CASE WHEN FTN_ID_MONTO = 28 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_CVP_28,
    SUM(CASE WHEN FTN_ID_MONTO = 29 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_CVT_29,
    SUM(CASE WHEN FTN_ID_MONTO = 30 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_SAR_30,
    SUM(CASE WHEN FTN_ID_MONTO = 31 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_RET_31,
    SUM(CASE WHEN FTN_ID_MONTO = 32 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_CVP_32,
    SUM(CASE WHEN FTN_ID_MONTO = 33 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_CVT_33,
    SUM(CASE WHEN FTN_ID_MONTO = 34 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_VIV_34,
    SUM(CASE WHEN FTN_ID_MONTO = 35 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_VIV_35,
    SUM(CASE WHEN FTN_ID_MONTO = 36 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_VIE_36,
    SUM(CASE WHEN FTN_ID_MONTO = 37 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_VIE_37,
    SUM(CASE WHEN FTN_ID_MONTO = 44 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_CSO_44,
    SUM(CASE WHEN FTN_ID_MONTO = 45 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_AVO_45,
    SUM(CASE WHEN FTN_ID_MONTO = 46 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_ACR_46,
    SUM(CASE WHEN FTN_ID_MONTO = 47 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_ALP_47,
    SUM(CASE WHEN FTN_ID_MONTO = 48 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_AAS_48,
    SUM(CASE WHEN FTN_ID_MONTO = 49 AND #SR_SUBPROCESO# = 120 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_AAS_49,
    0 AS FTC_IMPORTE_AST_31,
    0 AS FTC_IMPORTE_ASD_32,
    0 AS FTC_INTERES_AST_33,
    0 AS FTC_INTERES_ASD_34,
    SUM(CASE WHEN FTN_ID_MONTO = 23 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_SAR_23,
    SUM(CASE WHEN FTN_ID_MONTO = 24 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_RET_24,
    SUM(CASE WHEN FTN_ID_MONTO = 25 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_CV_25,
    SUM(CASE WHEN FTN_ID_MONTO = 26 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_CV_26,
    SUM(CASE WHEN FTN_ID_MONTO = 27 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_SAR_27,
    SUM(CASE WHEN FTN_ID_MONTO = 28 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_INTERES_RET_28,
    SUM(CASE WHEN FTN_ID_MONTO = 29 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_INTERES_CV_29,
    SUM(CASE WHEN FTN_ID_MONTO = 30 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_INTERES_CV_30,
    SUM(CASE WHEN FTN_ID_MONTO = 31 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_AT_31,
    SUM(CASE WHEN FTN_ID_MONTO = 32 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IMPORTE_AD_32,
    SUM(CASE WHEN FTN_ID_MONTO = 33 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_INTERES_AT_33,
    SUM(CASE WHEN FTN_ID_MONTO = 34 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_INTERES_AD_34,
    SUM(CASE WHEN FTN_ID_MONTO = 35 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_SAR_35,
    SUM(CASE WHEN FTN_ID_MONTO = 36 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_RET_36,
    SUM(CASE WHEN FTN_ID_MONTO = 37 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_CVP_37,
    SUM(CASE WHEN FTN_ID_MONTO = 38 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_CVT_38,
    SUM(CASE WHEN FTN_ID_MONTO = 39 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_SAR_39,
    SUM(CASE WHEN FTN_ID_MONTO = 40 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_RET_40,
    SUM(CASE WHEN FTN_ID_MONTO = 41 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_CVP_41,
    SUM(CASE WHEN FTN_ID_MONTO = 42 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_CVT_42,
    SUM(CASE WHEN FTN_ID_MONTO = 43 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_AST_43,
    SUM(CASE WHEN FTN_ID_MONTO = 44 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_ASD_44,
    SUM(CASE WHEN FTN_ID_MONTO = 45 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_AST_45,
    SUM(CASE WHEN FTN_ID_MONTO = 46 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_ASD_46,
    SUM(CASE WHEN FTN_ID_MONTO = 47 AND #SR_SUBPROCESO# = 122 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTC_IINTERES_TOT_47,
			SUM(
			  CASE WHEN FTN_ID_MONTO = 20 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END + 
			  CASE WHEN FTN_ID_MONTO = 21 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END +
			  CASE WHEN FTN_ID_MONTO = 22 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END +
			  CASE WHEN FTN_ID_MONTO = 23 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_IMPORTE_RCV_10,
			SUM(
			  CASE WHEN FTN_ID_MONTO = 20 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 THEN FTN_MONTO_PESOS ELSE 0 END +
			  CASE WHEN FTN_ID_MONTO = 21 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 THEN FTN_MONTO_PESOS ELSE 0 END +
			  CASE WHEN FTN_ID_MONTO = 22 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 THEN FTN_MONTO_PESOS ELSE 0 END +
			  CASE WHEN FTN_ID_MONTO = 23 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_RCV_11,
    SUM(CASE WHEN FTN_ID_MONTO = 24 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_IMPORTE_AVOL_12,
    SUM(CASE WHEN FTN_ID_MONTO = 24 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_AVOL_13,
    SUM(CASE WHEN FTN_ID_MONTO = 25 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_IMPORTE_RET_14,
    SUM(CASE WHEN FTN_ID_MONTO = 25 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_RET_15,
    SUM(CASE WHEN FTN_ID_MONTO = 41 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_IMPORTE_ALP_16,
    SUM(CASE WHEN FTN_ID_MONTO = 36 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_ALP_17,
    SUM(CASE WHEN FTN_ID_MONTO = 42 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_IMPORTE_SUB_18,
    SUM(CASE WHEN FTN_ID_MONTO = 37 AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_SUB_19,
			SUM(CASE WHEN FTN_ID_MONTO = 26  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 AND FTC_ID_VIVIENDA = 0 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_IMPORTE_APP_20,
			SUM(CASE WHEN FTN_ID_MONTO = 26  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 AND FTC_ID_VIVIENDA = 0 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_APP_21,
    0 AS FTN_IMPORTE_GUB_22,
    0 AS FTN_INTERES_GUB_23,
			SUM(CASE WHEN FTN_ID_MONTO = 26  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 AND FTC_ID_VIVIENDA = 1 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_IMPORTE_VIV_27,
			SUM(CASE WHEN FTN_ID_MONTO = 26  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 AND FTC_ID_VIVIENDA = 1 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_VIV_28,
			SUM(CASE WHEN FTN_ID_MONTO = 35  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 AND FTC_ID_VIVIENDA = 0 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_VIV_29,
			SUM(CASE WHEN FTN_ID_MONTO = 35  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 AND FTC_ID_VIVIENDA = 1 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_VIV_30,
			SUM(CASE WHEN FTN_ID_MONTO = 37  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_IMPORTE_REM_31,
			SUM(CASE WHEN FTN_ID_MONTO = 38  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_REM_32,
			SUM(CASE WHEN FTN_ID_MONTO = 39  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_IMPORTE_EXT_33,
			SUM(CASE WHEN FTN_ID_MONTO = 40  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 2 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_EXT_34,
			SUM(CASE WHEN FTN_ID_MONTO = 35  AND #SR_SUBPROCESO# = 118 AND FTN_TIPO_REG = 3 THEN FTN_MONTO_PESOS ELSE 0 END) AS FTN_INTERES_VIV_35
FROM #DELTA_ACL_ESP_200#
WHERE FTN_ESTATUS = 0
GROUP BY FTN_ID_ARCHIVO
SELECT
  CASE
    WHEN 120 == #SR_SUBPROCESO# THEN
      CONCAT(SUBSTR(FTC_LINEA, 1, 442), CASE WHEN SUBSTR(FTC_LINEA, 443, 1) = 1 THEN 2 ELSE 0 END, SUBSTR(FTC_LINEA,444, 177))
    WHEN 122 == #SR_SUBPROCESO# THEN
      RPAD(SUBSTR(FTC_LINEA, 1, 639), 650, ' ')
    WHEN 118 == #SR_SUBPROCESO# AND SUBSTR(FTC_LINEA, 1,2) = '02' THEN
      RPAD(CONCAT(SUBSTR(FTC_LINEA, 1, 279), CASE WHEN SUBSTR(FTC_LINEA, 280, 1) = 1 THEN 2 ELSE 0 END, SUBSTR(FTC_LINEA,281, 86)),450, ' ')
    WHEN 118 == #SR_SUBPROCESO# AND SUBSTR(FTC_LINEA, 1,2) = '03' THEN
      RPAD(CONCAT(SUBSTR(FTC_LINEA, 1, 279), CASE WHEN SUBSTR(FTC_LINEA, 280, 1) = 1 THEN 2 ELSE 0 END, SUBSTR(FTC_LINEA,281, 21)), 450, ' ')
    ELSE
      NULL
  END AS FTC_LINEA
  , AE300.FTN_NO_LINEA
FROM #DELTA_ACL_ESP_300# AE300
   LEFT JOIN #DELTA_ACL_ESP_LEE_ARCH# AELA
      ON AE300.FTN_ID_ARCHIVO = AELA.FTN_ID_ARCHIVO AND AE300.FTN_NO_LINEA = AELA.FTN_NO_LINEA
UNION ALL
SELECT
   CASE
        WHEN 120 == #SR_SUBPROCESO# THEN
          RPAD(CONCAT(RPAD(CONCAT('0109700153403001', SUBSTR(FTC_LINEA, 17, 11), '02', SUBSTR(FTC_LINEA, 30, 8)), 319),'1'),620)
        WHEN 122 == #SR_SUBPROCESO# THEN 
          CONCAT('0109710153403001', SUBSTR(AELA.FTC_LINEA,17,634)) 
        WHEN 118 == #SR_SUBPROCESO# THEN
           RPAD(CONCAT(RPAD(CONCAT('0103100153403001', SUBSTR(AELA.FTC_LINEA,17,21)) ,319), '2'), 450, " ")
     END
     FTC_LINEA
  ,1 FTN_NO_LINEA
FROM #DELTA_ACL_ESP_LEE_ARCH# AELA
WHERE SUBSTR(AELA.FTC_LINEA,1,2)  = '01'
  --AND AELA.FTN_ID_ARCHIVO = #SR_ID_ARCHIVO#
ORDER BY 2
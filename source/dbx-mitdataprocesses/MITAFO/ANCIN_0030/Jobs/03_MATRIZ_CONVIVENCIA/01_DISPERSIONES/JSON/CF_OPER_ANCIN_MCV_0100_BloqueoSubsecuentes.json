{
  "flow" : "DOIMSS",
  "id" : "5",
  "steps" :
    [
        {
          "step_id" : "001",
          "subprocess" : "MVC",
          "description" : [
            "descripcion - Este query para bloqueo de subsecuentes genera la tabla TEMP_DOIMSS_MCV_MONTOS_CLIENTE",
            "#PARAM@1# = #p_SR_FOLIO# = Numero de folio",
            "#PARAM@2# = #p_SR_FOLIO_REL# = Numero de folio",
            "#PARAM@3# = #p_SR_TIPO_MOV# = Tipo de movimiento Cargo o Abono",
            "#PARAM@4# = #p_SR_PROCESO# = Proceso",
            "#PARAM@5# = #p_SR_SUBPROCESO# = Subproceso"
          ],
          "value": [
              "SELECT '#PARAM@1#' as FTC_FOLIO",
              ",'#PARAM@2#' as FTC_FOLIO_REL",
              ",#PARAM@4# AS FCN_ID_PROCESO",
              ",#PARAM@5# AS FCN_ID_SUBPROCESO",
              ",DISP.FTN_NUM_CTA_INVDUAL",
              ",0 FCN_ID_TIPO_SUBCTA",
              ",SUM(NVL((CASE WHEN DISP.FFN_ID_CONCEPTO_MOV IN (637,638,1002,1003) THEN DISP.FTF_MONTO_ACCIONES",
              "ELSE DISP.FTF_MONTO_PESOS",
              "END),0)) FTN_MONTO",
              ",CMOV.FCN_ID_TIPO_MONTO",
              "FROM   CIERREN_ETL.TTSISGRAL_ETL_DISPERSION DISP",
              "INNER JOIN CIERREN_ETL.TTSISGRAL_ETL_VAL_IDENT_CTE IDNT",
              "ON (DISP.FTC_FOLIO = IDNT.FTC_FOLIO",
              "AND DISP.FTN_NUM_CTA_INVDUAL = IDNT.FTN_NUM_CTA_INVDUAL AND (DISP.FTN_NSS = IDNT.FTN_NSS OR DISP.FTC_CURP = IDNT.FTC_CURP))",
              "INNER JOIN CIERREN.TFAFOGRAL_CONFIG_CONCEP_MOV CMOV",
              "ON (DISP.FFN_ID_CONCEPTO_MOV = CMOV.FFN_ID_CONCEPTO_MOV)",
              "WHERE ",
              "DISP.FTC_FOLIO = '#PARAM@2#'",
              "AND   DISP.FFN_ID_CONCEPTO_MOV IN (231,637,638,1002,1003)",
              "AND   (CASE WHEN DISP.FFN_ID_CONCEPTO_MOV IN (637,638,1002,1003) THEN DISP.FTF_MONTO_ACCIONES",
              "ELSE DISP.FTF_MONTO_PESOS",
              "END) > 0",
              "AND   DISP.FNN_ID_VIV_GARANTIA =  1",
              "AND   IDNT.FTN_ESTATUS_DIAG = 1",
              "GROUP BY ",
              "FCN_ID_PROCESO,",
              "FCN_ID_SUBPROCESO,",
              "DISP.FTN_NUM_CTA_INVDUAL,",
              "FCN_ID_TIPO_SUBCTA,",
              "FCN_ID_TIPO_MONTO"
          ]
        }
    ]
}
SELECT

CASE 	
	WHEN CVE_SIEFORE IS NULL 
	THEN '00' 
	ELSE CVE_SIEFORE
	END AS CVE_SIEFORE,

CASE
	WHEN FTN_NUM_CTA_INVDUAL IS NULL 
	THEN '0000000000'
	ELSE FTN_NUM_CTA_INVDUAL
  END AS FTN_NUM_CTA_INVDUAL,

CASE
	WHEN DVCUE IS NULL 
	THEN '0'
	ELSE DVCUE
  END AS DVCUE,

SUBSTR(LPAD(ROW_NUMBER() OVER (ORDER BY FFN_CODMOV ) , 8, '0'), -8) AS NUMREG,

CASE
	WHEN FFN_CODMOV IS NULL 
	THEN '000' 
	ELSE FFN_CODMOV
  END AS FFN_CODMOV,

CASE
	WHEN NSSTRA IS NULL 
	THEN '           ' 
	ELSE SUBSTR('           ',1,(11-LENGTH(NSSTRA)))||NSSTRA
	END AS NSSTRA,
    
CASE
	WHEN FCD_FECPRO IS NULL 
	THEN '00000000' 
	ELSE FCD_FECPRO
  END AS FCD_FECPRO,

'0000000' as SECPRO,

CASE
	WHEN FTD_FEHCCON IS NULL 
	THEN '00000000' 
	ELSE FTD_FEHCCON
  END AS FTD_FEHCCON,

CASE
	WHEN FCN_VALOR_ACCION IS NULL 
	THEN '000000000000'
	ELSE FCN_VALOR_ACCION
  END AS FCN_VALOR_ACCION,

CASE
	WHEN FECTRA IS NULL 
	THEN '00000000' 
	ELSE FECTRA
  END AS FECTRA,

'128'  AS SECLOT,

'00000000' as FNN_CORREL,

CASE
	WHEN FND_FECHA_PAGO_SUA IS NULL 
	THEN '00000000' 
	ELSE FND_FECHA_PAGO_SUA
  END AS FND_FECHA_PAGO,

CASE
	WHEN FNC_PERIODO_PAGO_PATRON IS NULL 
	THEN  '000000' 
	ELSE FNC_PERIODO_PAGO_PATRON
  END AS FNC_PERIODO_PAGO_PATRON,

'000000' as FNC_FOLIO_PAGO_SUA,

'00000000' as FECSUA,

'DISP-ISSSTE' AS NSSEMP,

CASE
	WHEN FFN_CODMOV = 105  
	THEN '000000000000000'
	ELSE CASE
		WHEN MONPES1 IS NULL 
		THEN '000000000000000'
		ELSE MONPES1 END
  END AS MONPES_1,

CASE
	WHEN FFN_CODMOV = 105  
	THEN '000000000000000' 
	ELSE CASE
		WHEN MONCUO1 IS NULL 
		THEN '000000000000000' 
		ELSE MONCUO1 END
  END AS MONCUO_1,

CASE
	WHEN FFN_CODMOV = 106 OR FFN_CODMOV = 210
	THEN CASE
	  WHEN MONPES2 IS NULL
	  THEN '000000000000000'
	  ELSE MONPES2 END
	ELSE '000000000000000'
END AS MONPES_2,

CASE 	
  WHEN FFN_CODMOV = 106 OR FFN_CODMOV = 210 	
  THEN CASE 	
    WHEN MONCUO2 IS NULL 	
	  THEN '000000000000000' 	
	  ELSE MONCUO2 END 	
  ELSE '000000000000000'
END AS MONCUO_2,

CASE
	WHEN FFN_CODMOV = 105 OR FFN_CODMOV = 106 OR FFN_CODMOV = 221
	THEN CASE
	  WHEN MONPES3 IS NULL 
	  THEN '000000000000000'
	  ELSE MONPES3 END
	ELSE '000000000000000' 
 END AS MONPES_3,

 CASE
	WHEN FFN_CODMOV = 105 OR FFN_CODMOV = 106 OR FFN_CODMOV = 221
	THEN CASE
	  WHEN MONCUO3 IS NULL 
	  THEN '000000000000000' 
	  ELSE MONCUO3 END
	ELSE '000000000000000' 
END AS MONCUO_3,

CASE
	WHEN FFN_CODMOV = 105 OR FFN_CODMOV = 106 OR FFN_CODMOV = 221
	THEN CASE
	  WHEN MONPES4 IS NULL 
	  THEN '000000000000000'
	  ELSE MONPES4 END
	ELSE '000000000000000' 
END AS MONPES_4,

CASE
	WHEN FFN_CODMOV = 105 OR FFN_CODMOV = 106 OR FFN_CODMOV = 221
	THEN CASE
	  WHEN MONCUO4 IS NULL 
	  THEN '000000000000000' 
	  ELSE MONCUO4 END
	ELSE '000000000000000' 
END AS MONCUO_4,

'000000000000000' AS MONPES_5,
'000000000000000' AS MONCUO_5,
'000000000000000' AS MONPES_6,
'000000000000000' AS MONCUO_6,
'000000000000000' AS MONPES_7,
'000000000000000' AS MONCUO_7,
'000000000000000' AS MONPES_8,
'000000000000000' AS MONCUO_8,
'000000000000000' AS MONPES_9,
'000000000000000' AS MONCUO_9,
'00000000' AS FECHA_1,
'00000000' AS FECHA_2,
'00000000' AS FND_FECVRCV,
CASE
	WHEN FND_FECHA_VALOR_IMSS_ACV_VIV IS NULL 
	THEN '00000000' 
	ELSE FND_FECHA_VALOR_IMSS_ACV_VIV
  END AS FND_FECHA_VALOR_IMSS_ACV_VIV,

'00000000' AS FECVGUB,

CASE
	WHEN  CVE_SIEFORE = '02' OR CVE_SIEFORE = '04' 
	THEN '01'
	ELSE '02'
  END AS CVESERV,

'00000' AS VARMAX

FROM #CATALOG_SCHEMA#.#tabla_delta#
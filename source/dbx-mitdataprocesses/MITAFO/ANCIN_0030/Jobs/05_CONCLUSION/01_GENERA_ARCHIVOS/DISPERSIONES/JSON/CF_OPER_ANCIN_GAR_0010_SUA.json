{
  "flow" : "DOIMSS",
  "id" : "4",
  "steps" :
    [
         {
          "step_id" : "001",
          "subprocess" : "Generacion de archivos SUA",
          "description" : [
            "#PARAM@1# = folio",
            "#PARAM@2# = CIERREN_ETL.TTSISGRAL_ETL_MOVIMIENTOS" ,
            "#PARAM@3# = CIERREN.TNAFORECA_SUA" 
          ],
          "value": [
                " SELECT"
                 ,"Y.FTC_FOLIO,"
                 ,"Y.FTC_FOLIO_SUA,"
                 ,"Y.FTN_NUM_CTA_INVDUAL,"
                 ,"Y.FNN_ID_REFERENCIA,"
                 ,"Y.FTD_FEH_LIQUIDACION,"
                 ,"lpad(replace (to_char( Y.DISP_MONRET, 'FM99999.90'),'.'),7,0)  as DISP_MONRET,"
                 ,"lpad(replace (to_char( Y.DISP_ACTRET, 'FM99999.90'),'.'),7,0)  as DISP_ACTRET,"
                 ,"lpad(replace (to_char( Y.DISP_MONCVE, 'FM99999.90'),'.'),7,0)  as DISP_MONCVE,"
                 ,"lpad(replace (to_char( Y.DISP_ACTCVE, 'FM99999.90'),'.'),7,0)  as DISP_ACTCVE,"
                 ,"lpad(replace (to_char( Y.DISP_MONVIV, 'FM99999.90'),'.'),7,0)  as DISP_MONVIV,"
                 ,"lpad(replace (to_char( Y.DISP_REMVIV,  'FM9999999999999.90'),'.'),15,0)   as DISP_REMVIV,"
                 ,"lpad(replace (to_char( Y.DISP_APINTREM, 'FM9999999999999.90'),'.'),15,0)  as DISP_APINTREM,"
                 ,"lpad(replace (to_char( Y.DISP_INTGENEXTVIV, 'FM9999999999999.90'),'.'),15,0)  as DISP_INTGENEXTVIV,"
                 ,"lpad(replace (to_char( Y.DISP_MONVOL, 'FM99999.90'),'.'),7,0)  as DISP_MONVOL,"
                 ,"lpad(replace (to_char( Y.DISP_APINTVIVEXT, 'FM9999999999999.90'),'.'),15,0)  as DISP_APINTVIVEXT,"
                 ,"lpad(replace (to_char( Y.DISP_ACR, 'FM9999999999999.90'),'.'),15,0)  as DISP_ACR,"
                 ,"lpad(replace (to_char( Y.DISP_CUOSOC, 'FM99999.90'),'.'),7,0)  as DISP_CUOSOC,"
                 ,"lpad(replace (to_char( Y.DISP_ACTCSO, 'FM99999.90'),'.'),7,0)  as DISP_ACTCSO,"
                 ,"lpad(replace (to_char( Y.DISP_APOEST, 'FM99999.90'),'.'),7,0)  as DISP_APOEST,"
                 ,"lpad(replace (to_char( Y.DISP_ACTEST, 'FM99999.90'),'.'),7,0)  as DISP_ACTEST,"
                 ,"lpad(replace (to_char( Y.DISP_APOESP, 'FM99999.90'),'.'),7,0)  as DISP_APOESP,"
                 ,"lpad(replace (to_char( Y.DISP_ACTESP, 'FM99999.90'),'.'),7,0)  as DISP_ACTESP,"
                 ,"Z.FNN_NUMREG as FNN_NUMREG_SUA,"
                 ,"Z.FNC_TIPREG as FNC_TIPREG_SUA,"
                 ,"Z.FTN_NSS as FTN_NSS_SUA,"
                 ,"to_char(Z.FTN_CONS_REG_LOTE) as FTN_CONS_REG_LOTE_SUA,"
                 ,"Z.FTC_RFC as FTC_RFC_SUA,"
                 ,"Z.FTC_CURP as FTC_CURP_SUA,"
                 ,"Z.FTC_NOMBRE as FTC_NOMBRE_SUA,"
                 ,"Z.FNC_PERIODO_PAGO_PATRON as FNC_PERDO_PAGO_PATRN_SUA,"
                 ,"Z.FND_FECHA_PAGO as FND_FECHA_PAGO_SUA,"
                 ,"Z.FND_FECHA_VALOR_IMSS_ACV_VIV as FND_FEC_VALOR_IMSS_SUA,"
                 ,"Z.FNN_ULTIMO_SALARIO_INT_PER as FNN_ULTIMO_SALARIO_INT_PER_SUA,"
                 ,"Z.FNC_FOLIO_PAGO_SUA as FNC_FOLIO_PAGO_SUA,"
                 ,"Z.FNC_REG_PATRONAL_IMSS as FNC_REG_PATRN_IMSS_SUA,"
                 ,"Z.FNC_RFC_PATRON as FNC_RFC_PATRON_SUA,"
                 ,"to_char(Z.FNN_DIAS_COTZDOS_BIMESTRE) as FNN_DIAS_COTZDOS_BIM_SUA,"
                 ,"to_char(Z.FNN_DIAS_INCAP_BIMESTRE) as FNN_DIAS_INCAP_BIM_SUA,"
                 ,"to_char(Z.FNN_DIAS_AUSENT_BIMESTRE) as FNN_DIAS_AUSENT_BIM_SUA,"
                 ,"to_char(Z.FNN_ID_VIV_GARANTIA) as FNN_ID_VIV_GARANTIA_SUA,"
                 ,"Z.FNN_APLIC_INT_VIVIENDA as FNN_APLIC_INT_VIV_SUA,"
                 ,"Z.FNC_MOTIVO_LIBCION_APORT as FNC_MOTIVO_LIBCION_APORT_SUA,"
                 ,"Z.FND_FECHA_PAGO_CUOTA_GUB as FND_FEC_PAGO_CUOTA_GUB_SUA,"
                 ,"Z.FND_FECHA_VALOR_RCV as FND_FEC_VALOR_RCV_SUA,"
                 ,"Z.FND_FECTRA as FND_FECTRA_SUA,"
                 ,"to_char(Z.FNN_SECLOT) as FNN_SECLOT_SUA,"
                 ,"Z.FNN_AFORE as FNN_AFORE_SUA,"
                 ,"Z.FNN_DEVPAG as FNN_DEVPAG_SUA,"
                 ,"Z.FNN_CVE_ENT_RECEP_PAGO as FNN_CVE_ENT_RECEP_PAGO_SUA,"
                 ,"Z.FNN_NSS_ISSSTE as FNN_NSS_ISSSTE_SUA,"
                 ,"Z.FNC_DEPEND_CTRO_PAGO as FNC_DEPEND_CTRO_PAGO_SUA,"
                 ,"Z.FNN_CTRO_PAGO_SAR as FNN_CTRO_PAGO_SAR_SUA,"
                 ,"Z.FNN_CVE_RAMO as FNN_CVE_RAMO_SUA,"
                 ,"Z.FNC_CVE_PAGADURIA as FNC_CVE_PAGADURIA_SUA,"
                 ,"Z.FNN_SUELDO_BASICO_COTIZ_RCV as FNN_SUELDO_BAS_COTIZ_RCV_SUA,"
                 ,"Z.FNC_ID_TRABAJADOR_BONO as FNC_ID_TRAB_BONO_SUA,"
                 ,"Z.FND_FEH_CRE as FND_FEH_CRE_SUA,"
                 ,"Z.FNC_USU_CRE as FNC_USU_CRE_SUA"
                 ,"FROM"
                 ,"(select FTC_FOLIO,"
                 ,"FTC_FOLIO_SUA,"
                 ,"FTN_NUM_CTA_INVDUAL,"
                 ,"FCN_ID_TIPO_MOV,"
                 ,"FNN_ID_REFERENCIA,"
                 ,"FTD_FEH_LIQUIDACION,"
                 ,"sum(DISP_MONRET) as DISP_MONRET,"
                 ,"sum(DISP_ACTRET) as DISP_ACTRET,"
                 ,"sum(DISP_MONCVE) as DISP_MONCVE,"
                 ,"sum(DISP_ACTCVE) as DISP_ACTCVE,"
                 ,"sum(DISP_MONVIV) as DISP_MONVIV,"
                 ,"sum(DISP_REMVIV) as DISP_REMVIV,"
                 ,"sum(DISP_APINTREM) as DISP_APINTREM,"
                 ,"sum(DISP_INTGENEXTVIV) as DISP_INTGENEXTVIV,"
                 ,"sum(DISP_MONVOL) as DISP_MONVOL,"
                 ,"sum(DISP_APINTVIVEXT) as DISP_APINTVIVEXT,"
                 ,"sum(DISP_ACR) as DISP_ACR,"
                 ,"sum(DISP_CUOSOC) as DISP_CUOSOC,"
                 ,"sum(DISP_ACTCSO) as DISP_ACTCSO,"
                 ,"sum(DISP_APOEST) as DISP_APOEST,"
                 ,"sum(DISP_ACTEST) as DISP_ACTEST,"
                 ,"sum(DISP_APOESP) as DISP_APOESP,"
                 ,"sum(DISP_ACTESP) as DISP_ACTESP"
                 ,"from"
                 ,"(select"
                 ,"FTC_FOLIO,"
                 ,"CASE WHEN(FTC_FOLIO_REL is null ) THEN FTC_FOLIO  ELSE FTC_FOLIO_REL END  FTC_FOLIO_SUA,"
                 ,"FTN_NUM_CTA_INVDUAL,"
                 ,"FCN_ID_TIPO_MOV,"
                 ,"FNN_ID_REFERENCIA,"
                 ,"FTF_MONTO_PESOS,"
                 ,"FTF_MONTO_ACCIONES,"
                 ,"FTD_FEH_LIQUIDACION,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 221 ) THEN FTF_MONTO_PESOS  ELSE 0 END  DISP_MONRET,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 222 ) THEN FTF_MONTO_PESOS  ELSE 0 END  DISP_ACTRET,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 223 ) THEN FTF_MONTO_PESOS  ELSE 0 END  DISP_MONCVE,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 224 ) THEN FTF_MONTO_PESOS  ELSE 0 END  DISP_ACTCVE,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 225 ) THEN FTF_MONTO_PESOS  ELSE 0 END  DISP_MONVIV,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 226 ) THEN FTF_MONTO_PESOS  ELSE 0 END  DISP_REMVIV,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 226 ) THEN FTF_MONTO_ACCIONES  ELSE 0 END  DISP_APINTREM,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 227 ) THEN FTF_MONTO_PESOS  ELSE 0 END  DISP_INTGENEXTVIV,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 228 ) THEN FTF_MONTO_PESOS  ELSE 0 END  DISP_MONVOL,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 227 ) THEN FTF_MONTO_ACCIONES  ELSE 0 END  DISP_APINTVIVEXT,"
                 ,"CASE WHEN(FCN_ID_CONCEPTO_MOV = 229 ) THEN FTF_MONTO_PESOS  ELSE 0 END  DISP_ACR,"
                 ,"0 as DISP_CUOSOC,"
                 ,"0 as DISP_ACTCSO,"
                 ,"0 as DISP_APOEST,"
                 ,"0 as DISP_ACTEST,"
                 ,"0 as DISP_APOESP,"
                 ,"0 as DISP_ACTESP"
                 ,"FROM #PARAM@2#"
                 ,"WHERE FTC_FOLIO='#PARAM@1#'"
                 ,") A"
                 ,"GROUP BY"
                 ,"FTC_FOLIO,"
                 ,"FTC_FOLIO_SUA,"
                 ,"FTN_NUM_CTA_INVDUAL,"
                 ,"FCN_ID_TIPO_MOV,"
                 ,"FNN_ID_REFERENCIA,"
                 ,"FTD_FEH_LIQUIDACION"
                 ,")Y"
                 ,"LEFT JOIN"
                 ,"#PARAM@3# Z"
                 ,"ON  Z.FNN_ID_REFERENCIA=Y.FNN_ID_REFERENCIA"
                 ,"AND Z.FTC_FOLIO=Y.FTC_FOLIO_SUA"
                 ,"AND Z.FTN_NUM_CTA_INVDUAL=Y.FTN_NUM_CTA_INVDUAL" 
          ]
        },
        {
          "step_id" : "002",
          "subprocess" : "Generacion de archivos General",
          "description" : [
             "#PARAM@1# = #P_SR_FECHA_LOTE# =",
             "#PARAM@2# = #P_SR_SEC_LOTE# =",
             "#PARAM@3# = #P_CX_CRE_ESQUEMA# =",
             "#PARAM@4# = #P_TL_CRE_ETL_MOVIMIENTOS# =",
             "#PARAM@5# = #P_CX_CRN_ESQUEMA# =",
             "#PARAM@6# = #P_TL_CRN_MOV_SUBCTA# =",
             "#PARAM@7# = #P_TL_CRN_CONFIG_MOV_ITGY# =",
             "#PARAM@8# = #P_TL_CRN_ARCHIVO_FOLIO# =",
             "#PARAM@9# = #P_TL_CRN_TIPO_SUBCTA# =",
             "#PARAM@10# = #P_TL_MAP_NCI_ITGY# =",
             "#PARAM@11# = #P_FL_VIGENCIA# =",
             "#PARAM@12# = #P_TL_CRN_VALOR_ACCION# =",
             "#PARAM@13# = #P_SR_FOLIO# ="
                  ],
         "value": [
              "SELECT"
              ,"LPAD(MOV.FTN_NUM_CTA_INVDUAL,10,'0') AS FTN_NUM_CTA_INVDUAL"
              ,",MOV.FCN_ID_TIPO_SUBCTA"
              ,",CEQ.FFN_ID_CONCEPTO_MOV"
              ,",LPAD(NVL(SUBSTR(CEQ.FFN_COD_MOV_ITGY,0,3),0),3,'0') AS FFN_COD_MOV_ITGY"
              ,",LPAD(NVL(F.FTN_ID_ARCHIVO,'0'),7,'0') AS FTN_ID_ARCHIVO"
              ,",LPAD(NVL(TO_CHAR(MOV.FTD_FEH_LIQUIDACION,'YYYYMMDD'),'0'),8,'0') AS FTD_FEH_LIQUIDACION"
              ,",LPAD(NVL('#PARAM@1#','0'),8,'0') FND_FECTRA_SUA --PARÁMETRO"
              ,",LPAD(NVL('#PARAM@2#','0'),3,'0') FNN_SECLOT_SUA --PARÁMETRO"
              ,",LPAD(NVL(MOV.FNN_ID_REFERENCIA,'0'),8,'0') FNN_ID_REFERENCIA"
              ,",'00000000' FND_FECHA_1"
              ,",'00000000' FND_FECHA_2"
              ,",'00000000' FND_FECVGUB"
              ,",'00000' FNC_VARMAX"
              ,",MOV.FTC_FOLIO FTC_FOLIO"
              ,",NVL(MOV.FTC_FOLIO_REL,MOV.FTC_FOLIO) FTC_FOLIO_SUA"
              ,",MOV.FCN_ID_SIEFORE"
              ,",MOV.FCN_ID_VALOR_ACCION"
              ,",LPAD(TRUNC(VA.FCN_VALOR_ACCION,7)*10000000,12,0) FCN_VALOR_ACCION"
              ,",MOV.FCN_ID_TIPO_MOV"
              ,",MOV.FTF_MONTO_PESOS AS FTF_MONTO_PESOS_S"
              ,",MOV.FTF_MONTO_ACCIONES AS FTF_MONTO_ACCIONES_S"
              ,",MOV.FCN_ID_CONCEPTO_MOV"
              ,",MOV.FCC_TABLA_NCI_MOV"
              ,",CEQ.FFN_POSICION_ITGY AS FFN_POSICION_ITGY"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 1 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END AS FTF_MONPES1"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 2 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END AS FTF_MONPES2"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 3 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END AS FTF_MONPES3"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 4 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END AS FTF_MONPES4"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 5 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END AS FTF_MONPES5"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 6 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END AS FTF_MONPES6"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 7 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END AS FTF_MONPES7"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 8 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END AS FTF_MONPES8"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 9 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END AS FTF_MONPES9"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 1 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END AS FTF_MONCUO1"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 2 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END AS FTF_MONCUO2"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 3 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END AS FTF_MONCUO3"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 4 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END AS FTF_MONCUO4"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 5 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END AS FTF_MONCUO5"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 6 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END AS FTF_MONCUO6"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 7 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END AS FTF_MONCUO7"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 8 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END AS FTF_MONCUO8"
              ,",CASE WHEN(CEQ.FFN_POSICION_ITGY = 9 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END AS FTF_MONCUO9"
              ,"    ,SUB.FCN_ID_CAT_SUBCTA"
              ,"    ,lpad(MP1.TMN_CVE_ITGY, 2, '0') FCN_CVE_SIEFORE"
              ,"FROM #PARAM@3# MOV"
              ,"    JOIN #PARAM@4# MS "
              ,"ON MOV.FCN_ID_TIPO_SUBCTA = MS.FCN_ID_TIPO_SUBCTA"
              ,"     JOIN #PARAM@5# CEQ"
              ,"ON MOV.FCN_ID_CONCEPTO_MOV = CEQ.FFN_ID_CONCEPTO_MOV AND MS.FRN_ID_MOV_SUBCTA = CEQ.FRN_ID_MOV_SUBCTA"
              ,"    JOIN #PARAM@6# F "
              ,"ON MOV.FTC_FOLIO = F.FTC_FOLIO"
              ,"    JOIN  #PARAM@7# SUB"
              ,"        ON SUB.FCN_ID_TIPO_SUBCTA = MOV.FCN_ID_TIPO_SUBCTA"
              ,"    JOIN #PARAM@8# MP1"
              ,"        ON MP1.TMN_CVE_NCI = MOV.FCN_ID_SIEFORE AND MP1.TMC_VIGENCIA = #PARAM@11#  AND MP1.TMC_USO='CTINDI'"
              ,"    JOIN #PARAM@9# VA"
              ,"        ON VA.FCN_ID_VALOR_ACCION = MOV.FCN_ID_VALOR_ACCION"
              ,"WHERE"
              ,"    MOV.FTC_FOLIO = '#PARAM@10#' --PARÁMETRO"
              ,"    AND CEQ.FFB_VIGENCIA = #PARAM@11#"
              ,"    AND (MS.FCN_ID_SUBPROCESO = 118 OR MS.FCN_ID_SUBPROCESO<>181)"
          ]
        },
        {
          "step_id" : "003",
          "subprocess" : "Generacion de archivos General, extracción de Cuentas Individual",
          "description": [
              "#PARAM@1# = #CIERREN.TTAFOGRAL_CTA_INVDUAL# =",
              "#PARAM@2# = #CIERREN.TTAFOGRAL_IND_CTA_INDV# =",
              "#PARAM@3# = #CIERREN.TMSISGRAL_MAP_NCI_ITGY# =",
              "#PARAM@4# = #P_FL_VIGENCIA# ="
                 ],
         "value":[
              "SELECT"
              ,"LPAD(NCI.FTN_NUM_CTA_INVDUAL, 10, '0') AS FTN_NUM_CTA_INVDUAL,"
              ,"NVL(NCI.FTC_DIG_VERIF, '0') AS FTC_DIG_VERIF,"
              ,"SUBSTR(NCIV.FCC_VALOR_IND, 1, 4) AS FCC_VALOR_IND,"
              ,"LPAD(NVL(MP2.TMN_CVE_ITGY,'00'),2,'0') AS FNC_CVESERV"
              ,"FROM"
              ,"#PARAM@1# NCI"
              ,"INNER JOIN"
              ,"#PARAM@2# NCIV "
              ,"ON NCI.FTN_NUM_CTA_INVDUAL = NCIV.FTN_NUM_CTA_INVDUAL"
              ,"INNER JOIN"
              ,"#PARAM@3# MP2"
              ,"ON NCIV.FCC_VALOR_IND = MP2.TMN_CVE_NCI AND MP2.TMC_VIGENCIA = #PARAM@4# AND MP2.TMC_USO='CTINDI'"
              ,"WHERE"
              ,"NCIV.FFN_ID_CONFIG_INDI = 1 AND NCIV.FTC_VIGENCIA = '1'"
          ]
        },
        {
          "step_id" : "004",
          "subprocess" : "Generacion de archivos General, extracción de SUA",
          "description": [
              "#PARAM@1# = #P_CX_CRN_ESQUEMA#.#P_TL_CRN_SUA# =",
              "#PARAM@2# = #P_SR_FOLIO# ="
           ],
          "value": [
             "  SELECT DISTINCT"
             ,"lpad(nvl(SUA.FNN_ID_REFERENCIA,'0'),8,'0') FNN_ID_REFERENCIA,"
             ,"SUA.FTC_FOLIO,"
             ,"lpad(SUA.FTN_NUM_CTA_INVDUAL,10,'0') FTN_NUM_CTA_INVDUAL,"
             ,"SUBSTR(SUA.FTC_RFC,1,11) FTN_NSS_SUA,"
             ,"SUBSTR(SUA.FTC_RFC,12,1) FTC_DIG_VERI,"
             ,"LPAD(NVL(SUA.FTN_NSS,'0'),11,'0') FNN_NSS_ISSSTE_SUA,"
             ,"LPAD(NVL(TO_CHAR(SUA.FND_FEH_CRE,'yyyymmdd'),'0'),8,'0') as FND_FEH_CRE_SUA,"
             ,"LPAD(NVL(TO_CHAR(SUA.FND_FECHA_PAGO,'YYYYMMDD'),'0'),8,'0') FND_FECHA_PAGO_SUA,"
             ,"LPAD(NVL(SUA.FNC_PERIODO_PAGO_PATRON,'0'),6,'0') as FNC_PERIODO_PAGO_PATRON,"
             ,"LPAD(NVL(SUA.FNC_FOLIO_PAGO_SUA,'0'),6,'0') as FNC_FOLIO_PAGO_SUA,"
             ,"LPAD(NVL(SUA.FNC_REG_PATRONAL_IMSS,'0'),11,'0') FNC_REG_PATRN_IMSS_SUA,"
             ,"LPAD(NVL(TO_CHAR(SUA.FND_FECHA_VALOR_RCV,'YYYYMMDD'),'0'),8,'0') as FND_FECHA_VALOR_RCV, "
             ,"LPAD(NVL(TO_CHAR(SUA.FND_FECHA_VALOR_IMSS_ACV_VIV ,'yyyymmdd'),'0'),8,'0') FND_FECHA_VALOR_IMSS_ACV_VIV,"
             ,"SUA.FNN_ID_VIV_GARANTIA as FNN_ID_VIV_GARANTIA_SUA,"
             ,"SUA.FNC_TIPREG"
             ,"FROM "
             ,"#PARAM@1# SUA"
             ,"WHERE SUA.FTC_FOLIO = '#PARAM@2#' AND SUA.FNC_TIPREG=02"
            ]
        },
        {
          "step_id" : "005",
          "subprocess" : "Generacion de archivos General, unión de Movimientos e Indicadores",
          "description": [
          "#PARAM@1# = #TEMP_DOIMSS_CTI_01_MOVIMIENTOS# =",
          "#PARAM@2# = #TEMP_DOIMSS_CTI_02_INDICADORES# ="
		      ],
          "value": [
            "SELECT"
              ,"#PARAM@1#.FTN_NUM_CTA_INVDUAL"
             ,",#PARAM@1#.FCN_ID_TIPO_SUBCTA"
             ,",#PARAM@1#.FFN_ID_CONCEPTO_MOV"
             ,",#PARAM@1#.FFN_COD_MOV_ITGY"
             ,",#PARAM@1#.FTN_ID_ARCHIVO"
             ,",#PARAM@1#.FTD_FEH_LIQUIDACION"
             ,",#PARAM@1#.FND_FECTRA_SUA"
             ,",#PARAM@1#.FNN_SECLOT_SUA"
             ,",#PARAM@1#.FNN_ID_REFERENCIA"
             ,",#PARAM@1#.FND_FECHA_1"
             ,",#PARAM@1#.FND_FECHA_2"
             ,",#PARAM@1#.FND_FECVGUB"
             ,",#PARAM@1#.FNC_VARMAX"
             ,",#PARAM@1#.FTC_FOLIO FTC_FOLIO"
             ,",#PARAM@1#.FTC_FOLIO_SUA"
             ,",#PARAM@1#.FCN_ID_SIEFORE"
             ,",#PARAM@1#.FCN_ID_VALOR_ACCION"
             ,",#PARAM@1#.FCN_VALOR_ACCION"
             ,",#PARAM@1#.FCN_ID_TIPO_MOV"
             ,",#PARAM@1#.FTF_MONTO_PESOS_S"
             ,",#PARAM@1#.FTF_MONTO_ACCIONES_S"
             ,",#PARAM@1#.FCN_ID_CONCEPTO_MOV"
             ,",#PARAM@1#.FCC_TABLA_NCI_MOV"
             ,",#PARAM@1#.FFN_POSICION_ITGY"
             ,",#PARAM@1#.FTF_MONPES1"
             ,",#PARAM@1#.FTF_MONPES2"
             ,",#PARAM@1#.FTF_MONPES3"
             ,",#PARAM@1#.FTF_MONPES4"
             ,",#PARAM@1#.FTF_MONPES5"
             ,",#PARAM@1#.FTF_MONPES6"
             ,",#PARAM@1#.FTF_MONPES7"
             ,",#PARAM@1#.FTF_MONPES8"
             ,",#PARAM@1#.FTF_MONPES9"
             ,",#PARAM@1#.FTF_MONCUO1"
             ,",#PARAM@1#.FTF_MONCUO2"
             ,",#PARAM@1#.FTF_MONCUO3"
             ,",#PARAM@1#.FTF_MONCUO4"
             ,",#PARAM@1#.FTF_MONCUO5"
             ,",#PARAM@1#.FTF_MONCUO6"
             ,",#PARAM@1#.FTF_MONCUO7"
             ,",#PARAM@1#.FTF_MONCUO8"
             ,",#PARAM@1#.FTF_MONCUO9"
             ,",#PARAM@1#.FCN_ID_CAT_SUBCTA"
             ,",#PARAM@1#.FCN_CVE_SIEFORE"
             ,",#PARAM@2#.FTC_DIG_VERIF"
             ,",#PARAM@2#.FNC_CVESERV"
             ,",#PARAM@2#.FCC_VALOR_IND"
             ,"FROM #PARAM@1#"
             ,"INNER JOIN #PARAM@2#"
             ,"ON #PARAM@1#.FTN_NUM_CTA_INVDUAL = #PARAM@2#.FTN_NUM_CTA_INVDUAL"
             ]
		      },
        {
          "step_id" : "006",
          "subprocess" : "Generacion de archivos General, unión con SUA",		
          "description":
          [
              "#PARAM@1# = #TEMP_DOIMSS_CTI_04_UNION# =",
              "#PARAM@2# = #TEMP_DOIMSS_CTI_03_SUA# ="
          ],
          "value":
              [
            "SELECT"
             ,"#PARAM@1#.FCN_CVE_SIEFORE"
             ,",#PARAM@1#.FTN_NUM_CTA_INVDUAL"
             ,",#PARAM@1#.FCN_ID_TIPO_SUBCTA"
             ,",#PARAM@1#.FCN_ID_CAT_SUBCTA"
             ,",#PARAM@1#.FFN_ID_CONCEPTO_MOV"
             ,",#PARAM@2#.FTC_DIG_VERI"
             ,",#PARAM@1#.FFN_COD_MOV_ITGY"
             ,",#PARAM@2#.FNN_NSS_ISSSTE_SUA"
             ,",#PARAM@2#.FTN_NSS_SUA"
             ,",#PARAM@2#.FND_FEH_CRE_SUA"
             ,",#PARAM@1#.FTN_ID_ARCHIVO"
             ,",#PARAM@1#.FTD_FEH_LIQUIDACION"
             ,",#PARAM@1#.FCN_VALOR_ACCION"
             ,",#PARAM@1#.FND_FECTRA_SUA"
             ,",#PARAM@1#.FNN_SECLOT_SUA"
             ,",#PARAM@1#.FNN_ID_REFERENCIA"
             ,",#PARAM@2#.FND_FECHA_PAGO_SUA"
             ,",#PARAM@2#.FNC_PERIODO_PAGO_PATRON"
             ,",#PARAM@2#.FNC_FOLIO_PAGO_SUA"
             ,",#PARAM@2#.FNC_REG_PATRN_IMSS_SUA"
             ,",#PARAM@1#.FND_FECHA_1"
             ,",#PARAM@1#.FND_FECHA_2"
             ,",#PARAM@2#.FND_FECHA_VALOR_RCV"
             ,",#PARAM@2#.FND_FECHA_VALOR_IMSS_ACV_VIV"
             ,",#PARAM@1#.FND_FECVGUB"
             ,",#PARAM@1#.FNC_CVESERV"
             ,",#PARAM@1#.FNC_VARMAX"
             ,",#PARAM@1#.FTC_FOLIO"
             ,",#PARAM@1#.FTC_FOLIO_SUA"
             ,",#PARAM@1#.FCN_ID_SIEFORE"
             ,",#PARAM@1#.FCN_ID_VALOR_ACCION"
             ,",#PARAM@1#.FCN_ID_TIPO_MOV"
             ,",#PARAM@1#.FTF_MONTO_PESOS_S"
             ,",#PARAM@1#.FTF_MONTO_ACCIONES_S"
             ,",#PARAM@1#.FCC_TABLA_NCI_MOV"
             ,",#PARAM@1#.FFN_POSICION_ITGY"
             ,",#PARAM@1#.FCN_ID_CONCEPTO_MOV"
             ,",#PARAM@1#.FCC_VALOR_IND"
             ,",#PARAM@1#.FTF_MONPES1"
             ,",#PARAM@1#.FTF_MONPES2"
             ,",#PARAM@1#.FTF_MONPES3"
             ,",#PARAM@1#.FTF_MONPES4"
             ,",#PARAM@1#.FTF_MONPES5"
             ,",#PARAM@1#.FTF_MONPES6"
             ,",#PARAM@1#.FTF_MONPES7"
             ,",#PARAM@1#.FTF_MONPES8"
             ,",#PARAM@1#.FTF_MONPES9"
             ,",#PARAM@1#.FTF_MONCUO1"
             ,",#PARAM@1#.FTF_MONCUO2"
             ,",#PARAM@1#.FTF_MONCUO3"
             ,",#PARAM@1#.FTF_MONCUO4"
             ,",#PARAM@1#.FTF_MONCUO5"
             ,",#PARAM@1#.FTF_MONCUO6"
             ,",#PARAM@1#.FTF_MONCUO7"
             ,",#PARAM@1#.FTF_MONCUO8"
             ,",#PARAM@1#.FTF_MONCUO9"
             ,",#PARAM@2#.FNN_ID_VIV_GARANTIA_SUA"
             ,",#PARAM@1#.FTC_DIG_VERIF"
             ,"FROM #PARAM@1#"
             ,"INNER JOIN #PARAM@2#"
             ,"ON #PARAM@1#.FNN_ID_REFERENCIA = #PARAM@2#.FNN_ID_REFERENCIA"
             ,"AND #PARAM@1#.FTC_FOLIO=#PARAM@2#.FTC_FOLIO"
             ,"AND #PARAM@1#.FTN_NUM_CTA_INVDUAL=#PARAM@2#.FTN_NUM_CTA_INVDUAL"
          ]
		    },
        {
          "step_id" : "007",
          "subprocess" : "Generacion de archivos General, Generación final del archivo SUA",		
          "description":
            [
                "#PARAM@1# = #CIERREN_ETL.TTSISGRAL_ETL_GEN_ARCHIVO# =",
				        "#PARAM@2# = #FTC_FOLIO# ="
            ],
            "value":
            [
            "SELECT "
            ,"COALESCE(FCN_CVE_SIEFORE, '00') AS CVE_SIEFORE,"
            ,"COALESCE(FTN_NUM_CTA_INVDUAL, '0000000000') AS FTN_NUM_CTA_INVDUAL,"
            ,"'0' AS DVCUE,"
            ,"LPAD(ROW_NUMBER()OVER (PARTITION BY FFN_COD_MOV_ITGY ORDER BY FTN_NUM_CTA_INVDUAL,FCN_CVE_SIEFORE),8,0) NUMREG,"
            ,"COALESCE(FFN_COD_MOV_ITGY, '000') AS FFN_CODMOV,"
            ,"COALESCE(FNN_NSS_ISSSTE_SUA || RPAD(' ', 11 - LENGTH(FNN_NSS_ISSSTE_SUA)), ' ') AS NSSTRA, "
            ,"COALESCE(FND_FEH_CRE_SUA, '00000000') AS FCD_FECPRO, "
            ,"COALESCE(FTN_ID_ARCHIVO, '0000000') AS SECPRO,"
            ,"COALESCE(FTD_FEH_LIQUIDACION, '00000000') AS FTD_FEHCCON,"
            ,"COALESCE(FCN_VALOR_ACCION, '000000000000') AS FCN_VALOR_ACCION, "
            ,"COALESCE(FND_FECTRA_SUA, '00000000') AS FECTRA,"
            ,"COALESCE(FNN_SECLOT_SUA, '000') AS SECLOT,"
            ,"COALESCE(FNN_ID_REFERENCIA, '00000000') AS FNN_CORREL, "
            ,"COALESCE(FND_FECHA_PAGO_SUA, '00000000') AS FND_FECHA_PAGO,"
            ,"COALESCE(FNC_PERIODO_PAGO_PATRON, '000000') AS FNC_PERIODO_PAGO_PATRON, "
            ,"COALESCE(FNC_FOLIO_PAGO_SUA, '000000') AS FNC_FOLIO_PAGO_SUA, "
            ,"COALESCE(FND_FECHA_PAGO_SUA, '00000000') AS FECSUA, "
            ,"COALESCE(FNC_REG_PATRN_IMSS_SUA || RPAD(' ', 11 - LENGTH(FNC_REG_PATRN_IMSS_SUA)), ' ') AS NSSEMP, "
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONPES1), 'FM9999999999999.90'), '.'), 15, '0'), '000000000000000') AS MONPES1,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONPES2), 'FM9999999999999.90'), '.'), 15, '0'), '000000000000000') AS MONPES2,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONPES3), 'FM9999999999999.90'), '.'), 15, '0'), '000000000000000') AS MONPES3,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONPES4), 'FM9999999999999.90'), '.'), 15, '0'), '000000000000000') AS MONPES4,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONPES5), 'FM9999999999999.90'), '.'), 15, '0'), '000000000000000') AS MONPES5,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONPES6), 'FM9999999999999.90'), '.'), 15, '0'), '000000000000000') AS MONPES6,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONPES7), 'FM9999999999999.90'), '.'), 15, '0'), '000000000000000') AS MONPES7,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONPES8), 'FM9999999999999.90'), '.'), 15, '0'), '000000000000000') AS MONPES8,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONPES9), 'FM9999999999999.90'), '.'), 15, '0'), '000000000000000') AS MONPES9,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONCUO1), 'FM99999999.9999990'), '.'), 15, '0'), '000000000000000') AS MONCUO1,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONCUO2), 'FM99999999.9999990'), '.'), 15, '0'), '000000000000000') AS MONCUO2,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONCUO3), 'FM99999999.9999990'), '.'), 15, '0'), '000000000000000') AS MONCUO3,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONCUO4), 'FM99999999.9999990'), '.'), 15, '0'), '000000000000000') AS MONCUO4,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONCUO5), 'FM99999999.9999990'), '.'), 15, '0'), '000000000000000') AS MONCUO5,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONCUO6), 'FM99999999.9999990'), '.'), 15, '0'), '000000000000000') AS MONCUO6,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONCUO7), 'FM99999999.9999990'), '.'), 15, '0'), '000000000000000') AS MONCUO7,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONCUO8), 'FM99999999.9999990'), '.'), 15, '0'), '000000000000000') AS MONCUO8,"
            ,"COALESCE(LPAD(REPLACE(TO_CHAR(SUM(FTF_MONCUO9), 'FM99999999.9999990'), '.'), 15, '0'), '000000000000000') AS MONCUO9,"
            ,"COALESCE(FND_FECHA_1, '00000000') AS FECHA_1,"
            ,"COALESCE(FND_FECHA_2, '00000000') AS FECHA_2,"
            ,"COALESCE(FND_FECHA_VALOR_RCV, '00000000') AS FND_FECVRCV,"
            ,"COALESCE(FND_FECHA_VALOR_IMSS_ACV_VIV, '00000000') AS FND_FECHA_VALOR_IMSS_ACV_VIV,"
            ,"COALESCE(FND_FECVGUB, '00000000') AS FECVGUB,"
            ,"'01' AS CVESERV,"
            ,"COALESCE(FNC_VARMAX, '00000') AS VARMAX"
            ,"FROM #PARAM@1#"
            ,"WHERE FTC_FOLIO = '#PARAM@2#' --PARÁMETRO"
            ,"GROUP BY  "
            ,"FCN_CVE_SIEFORE,"
            ,"FTN_NUM_CTA_INVDUAL,"
            ,"FTC_DIG_VERI,"
            ,"FFN_COD_MOV_ITGY,"
            ,"FNN_NSS_ISSSTE_SUA,"
            ,"FND_FEH_CRE_SUA,"
            ,"FTN_ID_ARCHIVO,"
            ,"FTD_FEH_LIQUIDACION,"
            ,"FCN_VALOR_ACCION,"
            ,"FND_FECTRA_SUA,"
            ,"FNN_SECLOT_SUA,"
            ,"FNN_ID_REFERENCIA,"
            ,"FND_FECHA_PAGO_SUA,"
            ,"FNC_PERIODO_PAGO_PATRON,"
            ,"FNC_FOLIO_PAGO_SUA,"
            ,"FND_FECHA_PAGO_SUA,"
            ,"FNC_REG_PATRN_IMSS_SUA,"
            ,"FND_FECHA_1,"
            ,"FND_FECHA_2,"
            ,"FND_FECHA_VALOR_RCV,"
            ,"FND_FECHA_VALOR_IMSS_ACV_VIV,"
            ,"FND_FECVGUB,"
            ,"FNC_VARMAX "
            ,"ORDER BY FFN_CODMOV"
            ]
		    },
        {
          "step_id" : "008",
          "subprocess" : "Generacion de archivos General",
          "description" : [
             "#PARAM@1# = TEMP_DOIMSS_GEN_SUA_01"
                  ],
         "value": [
              "SELECT "
             ,"    RPAD(NVL(FNC_TIPREG_SUA,' '),2,' ')  AS DISP_TIPREG_SUA ,"
             ,"    SUBSTR(CONCAT('0000000000', NVL(FTN_NUM_CTA_INVDUAL, '0000000000')), -10) AS DISP_NUMCUE,"
             ,"    NVL(RPAD(FTN_NSS_SUA, 11, ' '), '           ') AS DISP_NSSTRA,"
             ,"    SUBSTR(CONCAT('00000000', NVL(FNN_ID_REFERENCIA, '00000000')), -8) AS DISP_CORREL,"
             ,"    NVL(RPAD(FTC_RFC_SUA, 13, ' '), '             ') AS DISP_RFCTRA,"
             ,"    NVL(RPAD(FTC_CURP_SUA, 18, ' '), '                  ') AS DISP_CURP,"
             ,"    NVL(RPAD(FTC_NOMBRE_SUA, 50, ' '), '                                                  ') AS DISP_NOMAFI,"
             ,"    SUBSTR(CONCAT('000000', NVL(FNC_PERDO_PAGO_PATRN_SUA, '000000')), -6) AS DISP_PERPAG,"
             ,"    NVL(TO_CHAR(FND_FECHA_PAGO_SUA, 'yyyyMMdd'), '00000000') AS DISP_FECPAG,"
             ,"    NVL(TO_CHAR(FND_FEC_VALOR_RCV_SUA, 'yyyyMMdd'), '00000000') AS DISP_FECCRCV,"
             ,"    NVL(TO_CHAR(FND_FEC_PAGO_CUOTA_GUB_SUA, 'yyyyMMdd'), '00000000') AS DISP_FECVGUB,"
             ,"    NVL(TO_CHAR(FND_FEC_VALOR_IMSS_SUA, 'yyyyMMdd'), '00000000') AS DISP_FECVVIV,"
             ,"    SUBSTR(CONCAT('0000000', (floor(NVL(FNN_ULTIMO_SALARIO_INT_PER_SUA, 0) * 100))), -7) AS DISP_SALBAS,"
             ,"    NVL(RPAD(FNC_FOLIO_PAGO_SUA, 6, ' '),'      ') AS DISP_FOLSUA,"
             ,"    NVL(RPAD(FNC_REG_PATRN_IMSS_SUA, 11, ' '),'           ') AS DISP_NSSEMP,"
             ,"    NVL(RPAD(FNC_RFC_PATRON_SUA, 13, ' '),'             ') AS DISP_RFCEMP,"
             ,"    SUBSTR(RPAD(NVL(FNN_CVE_ENT_RECEP_PAGO_SUA, ' '), 3, ' '), 1, 3) AS DISP_CLAREC,"
             ,"    SUBSTR(CONCAT('00', NVL(FNN_DIAS_COTZDOS_BIM_SUA, '00')), -2) AS DISP_DIACOT,"
             ,"    SUBSTR(CONCAT('00', NVL(FNN_DIAS_INCAP_BIM_SUA, '00')), -2) AS DISP_INCAPA,"
             ,"    SUBSTR(CONCAT('00', NVL(FNN_DIAS_AUSENT_BIM_SUA, '00')), -2) AS DISP_AUSENT, "
             ,"    LPAD(NVL(DISP_MONRET,'0000000'),7,'0')  AS DISP_MONRET,  "
             ,"    LPAD(NVL(DISP_ACTRET,'0000000'),7,'0')  AS DISP_ACTRET,"
             ,"    '0000000' AS DISP_COMRET,"
             ,"    LPAD(NVL(DISP_MONCVE,'0000000'),7,'0')  AS DISP_MONCVE,"
             ,"    LPAD(NVL(DISP_ACTCVE,'0000000'),7,'0')  AS DISP_ACTCVE,"
             ,"    '0000000' AS DISP_COMCVE,"
             ,"    LPAD(NVL(DISP_MONVOL,'0000000'),7,'0')  AS DISP_MONVOL,"
             ,"    LPAD(NVL(DISP_MONVIV,'0000000'),7,'0')  AS DISP_MONVIV,"
             ,"    LPAD(NVL(DISP_CUOSOC,'0000000'),7,'0')  AS DISP_CUOSOC, "
             ,"    LPAD(NVL(DISP_ACTCSO,'0000000'),7,'0')  AS DISP_ACTCSO, "
             ,"    LPAD(NVL(DISP_APOEST,'0000000'),7,'0')  AS DISP_APOEST,"
             ,"    LPAD(NVL(DISP_ACTEST,'0000000'),7,'0')  AS DISP_ACTEST,"
             ,"    '0000000' AS DISP_COMEST,"
             ,"    LPAD(NVL(DISP_APOESP,'0000000'),7,'0')  AS DISP_APOESP,"
             ,"    LPAD(NVL(DISP_ACTESP,'0000000'),7,'0')  AS DISP_ACTESP,"
             ,"    '0000000' AS DISP_COMESP,"
             ,"    NVL(TO_CHAR(FND_FEC_VALOR_RCV_SUA, 'yyyyMMdd'), '00000000') AS DISP_FECLIQ_RCV,"
             ,"    NVL(TO_CHAR(FND_FEC_PAGO_CUOTA_GUB_SUA, 'yyyyMMdd'), '00000000') AS DISP_FECLIQ_GUB,"
             ,"    NVL(TO_CHAR(FND_FECTRA_SUA, 'yyyyMMdd'), '00000000') AS DISP_FECTRA, "
             ,"    SUBSTR(CONCAT('000', NVL(FNN_SECLOT_SUA, '000')), -3) AS DISP_SECLOT,"
             ,"    '001' AS DISP_AFORE,"
             ,"    '0' AS DISP_DEVPAG,"
             ,"    '000000000000000' AS DISP_ALP,"
             ,"    '000000000000000' AS DISP_ASA,"
             ,"    LPAD(NVL(DISP_REMVIV,'000000000000000'),15,'0')  AS DISP_REMVIV, "
             ,"    LPAD(NVL(DISP_APINTREM,'000000000000000'),15,'0')  AS DISP_APINTREM, "
             ,"    LPAD(NVL(DISP_INTGENEXTVIV,'000000000000000'),15,'0')  AS DISP_INTGENEXTVIV,"
             ,"    LPAD(NVL(DISP_APINTVIVEXT,'000000000000000'),15,'0')  AS DISP_APINTVIVEXT, "
             ,"    LPAD(NVL(DISP_ACR,'000000000000000'),15,'0')  AS DISP_ACR"
             ,"FROM #PARAM@1#"
            
          ]
        },
       {
          "step_id" : "009",
          "source" : "oracle",
		      "description" : "",
          "value" : [
              "DELETE FROM CIERREN_ETL.TTSISGRAL_ETL_GEN_ARCHIVO WHERE FTC_FOLIO = '#PARAM@1#'"
          ]
        },
        
          {
            "step_id" : "010",
            "subprocess" : "Generacion de archivos Subsecuentes",
            "description" : [
            "#PARAM@1# = SR_FECHA_ACCION",
            "#PARAM@2# = CIERREN_ETL.TTSISGRAL_ETL_GEN_ARCHIVO",
            "#PARAM@3# = SR_FTC_FOLIO"
            
          ],
          "value": [
              "SELECT"
            ,"  FTN_NUM_CTA_INVDUAL SUBSEC_NUMCUE,"
            ,"  FNN_NSS_ISSSTE_SUA SUBSEC_NSSTRA,  "
            ,"  lpad(replace(to_char(FTF_MONTO_PESOS_S, 'FM99999.90'),'.'),7,0) SUBSEC_VIVIENDA97, "
            ,"  lpad(nvl('#PARAM@1#','0'),8,'0') SUBSEC_FECCON,"
            ,"  FNC_PERIODO_PAGO_PATRON SUBSEC_PERPAG,"
            ,"  FND_FECTRA_SUA SUBSEC_FECTRA,"
            ,"  FNN_SECLOT_SUA SUBSEC_SECLOT,  "
            ,"  '01' SUBSEC_ESTATUS,"
            ,"   lpad(replace (to_char(FTF_MONTO_ACCIONES_S, 'FM999999999.999990'),'.'),15,0) SUBSEC_PARTICIPA97"
            ,"FROM #PARAM@2#"
            ,"WHERE FCN_ID_CONCEPTO_MOV=225 AND FNN_ID_VIV_GARANTIA_SUA=1"
            ,"AND FCC_TABLA_NCI_MOV ='VIV' AND FTC_FOLIO='#PARAM@3#'"   
          ]
        },
        {
            "step_id" : "011",
            "subprocess" : "Generacion de archivos Subsecuentes",
            "description" : [
            "#PARAM@1# = SR_FECHA_LOTE",
            "#PARAM@2# = SR_SEC_LOTE",
            "#PARAM@3# = SR_FOLIO"
            
          ],
          "value": [
          "SELECT"
          ,"   LPAD(MP1.TMN_CVE_ITGY, 2, '0') FCN_CVE_SIEFORE"    
          ,"  ,LPAD(MOV.FTN_NUM_CTA_INVDUAL,10,'0') FTN_NUM_CTA_INVDUAL"
          ,"  ,SUB.FCN_ID_TIPO_SUBCTA"
          ,"  ,SUB.FCN_ID_CAT_SUBCTA"
          ,"  ,CEQ.FFN_ID_CONCEPTO_MOV as FCN_ID_CONCEPTO_MOV"
          ,"  ,SUBSTR(SUA.FTC_RFC,12,1) FTC_DIG_VERI"  
          ,"  ,LPAD(NVL(SUBSTR(CEQ.FFN_COD_MOV_ITGY,0,3),0),3,'0') FFN_COD_MOV_ITGY"
          ,"  ,LPAD(NVL(SUA.FTN_NSS,'0'),11,'0') FNN_NSS_ISSSTE_SUA"
          ,"  ,SUBSTR(FTC_RFC,1,11) FTN_NSS_SUA"
          ,"  ,LPAD(NVL(TO_CHAR(SUA.FND_FEH_CRE,'YYYYMMDD'),'0'),8,'0') AS FND_FEH_CRE_SUA"
          ,"  ,LPAD(NVL(F.FTN_ID_ARCHIVO,'0'),7,'0') AS FTN_ID_ARCHIVO"
          ,"  ,LPAD(NVL(TO_CHAR(MOV.FTD_FEH_LIQUIDACION,'YYYYMMDD'),'0'),8,'0') AS FTD_FEH_LIQUIDACION"
          ,"  ,LPAD(TRUNC(FCN_VALOR_ACCION,7)*10000000,12,0) FCN_VALOR_ACCION"
          ,"  ,LPAD(NVL('#PARAM@1#','0'),8,'0') FND_FECTRA_SUA"  
          ,"  ,LPAD(NVL('#PARAM@2#','0'),3,'0') FNN_SECLOT_SUA"  
          ,"  ,LPAD(NVL(MOV.FNN_ID_REFERENCIA,'0'),8,'0') FNN_ID_REFERENCIA"
          ,"  ,LPAD(NVL(TO_CHAR(SUA.FND_FECHA_PAGO,'YYYYMMDD'),'0'),8,'0') FND_FECHA_PAGO_SUA"
          ,"  ,LPAD(NVL(SUA.FNC_PERIODO_PAGO_PATRON,'0'),6,'0') AS FNC_PERIODO_PAGO_PATRON"
          ,"  ,LPAD(NVL(SUA.FNC_FOLIO_PAGO_SUA,'0'),6,'0') AS FNC_FOLIO_PAGO_SUA"
          ,"  ,LPAD(NVL(SUA.FNC_REG_PATRONAL_IMSS,'0'),11,'0') FNC_REG_PATRN_IMSS_SUA"
          ,"  ,'00000000' FND_FECHA_1"
          ,"  ,'00000000' FND_FECHA_2"
          ,"  ,LPAD(NVL(TO_CHAR(SUA.FND_FECHA_VALOR_RCV,'YYYYMMDD'),'0'),8,'0') AS FND_FECHA_VALOR_RCV"
          ,"  ,LPAD(NVL(TO_CHAR(SUA.FND_FECHA_VALOR_IMSS_ACV_VIV ,'YYYYMMDD'),'0'),8,'0') FND_FECHA_VALOR_IMSS_ACV_VIV"
          ,"  ,'00000000' FND_FECVGUB"
          ,"  ,LPAD(NVL(MP2.TMN_CVE_ITGY,'00'),2,'0') FNC_CVESERV"
          ,"  ,'00000' FNC_VARMAX"
          ,"  ,MOV.FTC_FOLIO  FTC_FOLIO"
          ,"  ,NVL(MOV.FTC_FOLIO_REL,MOV.FTC_FOLIO) FTC_FOLIO_SUA"
          ,"  ,MOV.FCN_ID_SIEFORE"
          ,"  ,MOV.FCN_ID_VALOR_ACCION"
          ,"  ,MOV.FCN_ID_TIPO_MOV"
          ,"  ,MOV.FTF_MONTO_PESOS AS FTF_MONTO_PESOS_S"
          ,"  ,MOV.FTF_MONTO_ACCIONES AS FTF_MONTO_ACCIONES_S"
          ,"  --,MOV.FCN_ID_CONCEPTO_MOV AS FFN_ID_CONCEPTO_MOV"
          ,"  ,MOV.FCC_TABLA_NCI_MOV"
          ,"  ,CEQ.FFN_POSICION_ITGY AS FFN_POSICION_ITGY"
          ,"  ,SUBSTR(NCI.FCC_VALOR_IND,1,4) FCC_VALOR_IND"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 1 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END FTF_MONPES1"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 2 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END FTF_MONPES2"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 3 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END FTF_MONPES3"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 4 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END FTF_MONPES4"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 5 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END FTF_MONPES5"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 6 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END FTF_MONPES6"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 7 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END FTF_MONPES7"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 8 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END FTF_MONPES8"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 9 ) THEN MOV.FTF_MONTO_PESOS  ELSE 0 END FTF_MONPES9"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 1 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END FTF_MONCUO1"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 2 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END FTF_MONCUO2"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 3 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END FTF_MONCUO3"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 4 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END FTF_MONCUO4"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 5 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END FTF_MONCUO5"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 6 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END FTF_MONCUO6"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 7 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END FTF_MONCUO7"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 8 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END FTF_MONCUO8"
          ,"  ,CASE WHEN(CEQ.FFN_POSICION_ITGY = 9 ) THEN MOV.FTF_MONTO_ACCIONES  ELSE 0 END FTF_MONCUO9"
          ,"  ,SUA.FNN_ID_VIV_GARANTIA AS FNN_ID_VIV_GARANTIA_SUA"
          ,"  ,NCI.FTC_DIG_VERIF"
          ,"FROM"
          ,"   CIERREN_ETL.TTSISGRAL_ETL_MOVIMIENTOS MOV"
          ,"  ,CIERREN.TRAFOGRAL_MOV_SUBCTA MS"
          ,"  ,CIERREN.TFCRXGRAL_CONFIG_MOV_ITGY CEQ"
          ,"  ,CIERREN.TRAFOGRAL_ARCHIVO_FOLIO F"
          ,"  ,CIERREN.TTCRXGRAL_FOLIO FOL"
          ,"  ,("
          ,"    SELECT"
          ,"      NCI.FTN_NUM_CTA_INVDUAL"
          ,"      ,NVL(NCI.FTC_DIG_VERIF,'0') FTC_DIG_VERIF"
          ,"      ,SUBSTR(NCIV.FCC_VALOR_IND,1,4) FCC_VALOR_IND"
          ,"    FROM"
          ,"      CIERREN.TTAFOGRAL_CTA_INVDUAL NCI"
          ,"       ,CIERREN.TTAFOGRAL_IND_CTA_INDV NCIV"
          ,"    WHERE 1=1"
          ,"      AND NCIV.FFN_ID_CONFIG_INDI = 1"
          ,"          AND NCIV.FTC_VIGENCIA = '1'"
          ,"      AND NCI.FTN_NUM_CTA_INVDUAL = NCIV.FTN_NUM_CTA_INVDUAL"
          ,"  )NCI"
          ,"  ,CIERREN.TNAFORECA_SUA SUA"
          ,"  ,CIERREN.TCAFOGRAL_VALOR_ACCION VA"
          ,"  ,CIERREN.TMSISGRAL_MAP_NCI_ITGY MP1"
          ,"  ,CIERREN.TMSISGRAL_MAP_NCI_ITGY MP2"
          ,"    ,CIERREN.TCCRXGRAL_TIPO_SUBCTA SUB"
          ,"WHERE 1=1"
          ,"AND MOV.FTC_FOLIO = '#PARAM@3#'"
          ,"AND MOV.FCN_ID_TIPO_SUBCTA = MS.FCN_ID_TIPO_SUBCTA"
          ,"AND MOV.FCN_ID_TIPO_SUBCTA=SUB.FCN_ID_TIPO_SUBCTA"
          ,"AND MOV.FCN_ID_CONCEPTO_MOV = CEQ.FFN_ID_CONCEPTO_MOV"
          ,"AND MS.FRN_ID_MOV_SUBCTA = CEQ.FRN_ID_MOV_SUBCTA"
          ,"AND MOV.FTC_FOLIO_REL = F.FTC_FOLIO"
          ,"AND MOV.FTC_FOLIO = FOL.FTC_FOLIO"
          ,"AND MS.FCN_ID_SUBPROCESO = FOL.FCN_ID_SUBPROCESO"
          ,"AND NCI.FTN_NUM_CTA_INVDUAL = MOV.FTN_NUM_CTA_INVDUAL"  
          ,"AND MOV.FNN_ID_REFERENCIA = SUA.FNN_ID_REFERENCIA"
          ,"AND MOV.FTC_FOLIO_REL = SUA.FTC_FOLIO"
          ,"AND MOV.FTN_NUM_CTA_INVDUAL = SUA.FTN_NUM_CTA_INVDUAL"   
          ,"AND MOV.FCN_ID_VALOR_ACCION = VA.FCN_ID_VALOR_ACCION"
          ,"AND MOV.FCN_ID_SIEFORE = MP1.TMN_CVE_NCI"
          ,"AND NCI.FCC_VALOR_IND = MP2.TMN_CVE_NCI"
          ,"AND MP1.TMC_VIGENCIA = 1"
          ,"AND MP2.TMC_VIGENCIA = 1"
          ,"AND MP1.TMC_USO='CTINDI'"
          ,"AND MP2.TMC_USO='CTINDI'"
          ,"AND CEQ.FFB_VIGENCIA = 1"
          ,"AND ((SUA.FNC_TIPREG=02 AND FOL.FCN_ID_SUBPROCESO=9) OR (FOL.FCN_ID_SUBPROCESO<>9))" 
          ]
        }
    ]
}